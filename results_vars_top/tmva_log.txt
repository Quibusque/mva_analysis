DataSetInfo              : [dataset] : Added class "Signal"
                         : Add Tree final_tree of type Signal with 9783 events
DataSetInfo              : [dataset] : Added class "Background"
                         : Add Tree final_tree of type Background with 489081 events
                         : Dataset[dataset] : Class index : 0  name : Signal
                         : Dataset[dataset] : Class index : 1  name : Background
Factory                  : Booking method: [1mPyKeras[0m
                         : 
PyKeras                  : [dataset] : Create Transformation "D" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'C_Hnl_vertex_2DSig_BS' <---> Output : variable 'C_Hnl_vertex_2DSig_BS'
                         : Input : variable 'C_Hnl_vertex_cos2D' <---> Output : variable 'C_Hnl_vertex_cos2D'
                         : Input : variable 'C_pi_BS_ip_xy' <---> Output : variable 'C_pi_BS_ip_xy'
                         : Input : variable 'C_Ds_vertex_2DSig_BS' <---> Output : variable 'C_Ds_vertex_2DSig_BS'
PyKeras                  : [dataset] : Create Transformation "G" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'C_Hnl_vertex_2DSig_BS' <---> Output : variable 'C_Hnl_vertex_2DSig_BS'
                         : Input : variable 'C_Hnl_vertex_cos2D' <---> Output : variable 'C_Hnl_vertex_cos2D'
                         : Input : variable 'C_pi_BS_ip_xy' <---> Output : variable 'C_pi_BS_ip_xy'
                         : Input : variable 'C_Ds_vertex_2DSig_BS' <---> Output : variable 'C_Ds_vertex_2DSig_BS'
                         : Setting up tf.keras
                         : Using TensorFlow version 2
                         : Use Keras version from TensorFlow : tf.keras
                         :  Loading Keras Model 
                         : Loaded model from file: TMVA_keras_models/keras_shallow_model_old_TMVA.h5
Factory                  : [1mTrain all methods[0m
                         : Rebuilding Dataset dataset
                         : Building event vectors for type 2 Signal
                         : Dataset[dataset] :  create input formulas for tree final_tree
                         : Building event vectors for type 2 Background
                         : Dataset[dataset] :  create input formulas for tree final_tree
                         : Dataset[dataset] :  create input formulas for tree final_tree
                         : Dataset[dataset] :  create input formulas for tree final_tree
                         : Dataset[dataset] :  create input formulas for tree final_tree
                         : Dataset[dataset] :  create input formulas for tree final_tree
                         : Dataset[dataset] :  create input formulas for tree final_tree
                         : Dataset[dataset] :  create input formulas for tree final_tree
DataSetFactory           : [dataset] : Number of events in input trees
                         : 
                         : 
                         : Dataset[dataset] : Weight renormalisation mode: "EqualNumEvents": renormalises all event classes ...
                         : Dataset[dataset] :  such that the effective (weighted) number of events in each class is the same 
                         : Dataset[dataset] :  (and equals the number of events (entries) given for class=0 )
                         : Dataset[dataset] : ... i.e. such that Sum[i=1..N_j]{w_i} = N_classA, j=classA, classB, ...
                         : Dataset[dataset] : ... (note that N_j is the sum of TRAINING events
                         : Dataset[dataset] :  ..... Testing events are not renormalised nor included in the renormalisation factor!)
                         : Number of training and testing events
                         : ---------------------------------------------------------------------------
                         : Signal     -- training events            : 7827
                         : Signal     -- testing events             : 1956
                         : Signal     -- training and testing events: 9783
                         : Background -- training events            : 391265
                         : Background -- testing events             : 97816
                         : Background -- training and testing events: 489081
                         : 
DataSetInfo              : Correlation matrix (Signal):
                         : --------------------------------------------------------------------------------------------------
                         :                        C_Hnl_vertex_2DSig_BS C_Hnl_vertex_cos2D C_pi_BS_ip_xy C_Ds_vertex_2DSig_BS
                         : C_Hnl_vertex_2DSig_BS:                +1.000             +0.039        +0.189               -0.034
                         :    C_Hnl_vertex_cos2D:                +0.039             +1.000        +0.036               +0.001
                         :         C_pi_BS_ip_xy:                +0.189             +0.036        +1.000               -0.122
                         :  C_Ds_vertex_2DSig_BS:                -0.034             +0.001        -0.122               +1.000
                         : --------------------------------------------------------------------------------------------------
DataSetInfo              : Correlation matrix (Background):
                         : --------------------------------------------------------------------------------------------------
                         :                        C_Hnl_vertex_2DSig_BS C_Hnl_vertex_cos2D C_pi_BS_ip_xy C_Ds_vertex_2DSig_BS
                         : C_Hnl_vertex_2DSig_BS:                +1.000             +0.214        +0.066               +0.478
                         :    C_Hnl_vertex_cos2D:                +0.214             +1.000        +0.003               +0.181
                         :         C_pi_BS_ip_xy:                +0.066             +0.003        +1.000               +0.049
                         :  C_Ds_vertex_2DSig_BS:                +0.478             +0.181        +0.049               +1.000
                         : --------------------------------------------------------------------------------------------------
DataSetFactory           : [dataset] :  
                         : 
Factory                  : [dataset] : Create Transformation "D" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'C_Hnl_vertex_2DSig_BS' <---> Output : variable 'C_Hnl_vertex_2DSig_BS'
                         : Input : variable 'C_Hnl_vertex_cos2D' <---> Output : variable 'C_Hnl_vertex_cos2D'
                         : Input : variable 'C_pi_BS_ip_xy' <---> Output : variable 'C_pi_BS_ip_xy'
                         : Input : variable 'C_Ds_vertex_2DSig_BS' <---> Output : variable 'C_Ds_vertex_2DSig_BS'
Factory                  : [dataset] : Create Transformation "G" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'C_Hnl_vertex_2DSig_BS' <---> Output : variable 'C_Hnl_vertex_2DSig_BS'
                         : Input : variable 'C_Hnl_vertex_cos2D' <---> Output : variable 'C_Hnl_vertex_cos2D'
                         : Input : variable 'C_pi_BS_ip_xy' <---> Output : variable 'C_pi_BS_ip_xy'
                         : Input : variable 'C_Ds_vertex_2DSig_BS' <---> Output : variable 'C_Ds_vertex_2DSig_BS'
                         : Preparing the Decorrelation transformation...
                         : Preparing the Gaussian transformation...
TFHandler_Factory        :              Variable                     Mean                     RMS             [        Min                     Max ]
                         : ----------------------------------------------------------------------------------------------------------------------------
                         : C_Hnl_vertex_2DSig_BS:               0.012060                0.97596   [                -3.2904                 5.7307 ]
                         :    C_Hnl_vertex_cos2D:              0.0054665                0.99893   [                -3.2914                 5.7307 ]
                         :         C_pi_BS_ip_xy:             0.00048505                0.98998   [                -3.3989                 5.7307 ]
                         :  C_Ds_vertex_2DSig_BS:              0.0047030                0.99764   [                -3.2682                 5.7307 ]
                         : ----------------------------------------------------------------------------------------------------------------------------
Factory                  : Train method: PyKeras for Classification
                         : 
                         : 
                         : [1m================================================================[0m
                         : [1mH e l p   f o r   M V A   m e t h o d   [ PyKeras ] :[0m
                         : 
                         : Keras is a high-level API for the Theano and Tensorflow packages.
                         : This method wraps the training and predictions steps of the Keras
                         : Python package for TMVA, so that dataloading, preprocessing and
                         : evaluation can be done within the TMVA system. To use this Keras
                         : interface, you have to generate a model with Keras first. Then,
                         : this model can be loaded and trained in TMVA.
                         : 
                         : 
                         : <Suppress this message by specifying "!H" in the booking option>
                         : [1m================================================================[0m
                         : 
                         : Preparing the Decorrelation transformation...
                         : Preparing the Gaussian transformation...
TFHandler_PyKeras        :              Variable                     Mean                     RMS             [        Min                     Max ]
                         : ----------------------------------------------------------------------------------------------------------------------------
                         : C_Hnl_vertex_2DSig_BS:               0.012060                0.97596   [                -3.2904                 5.7307 ]
                         :    C_Hnl_vertex_cos2D:              0.0054665                0.99893   [                -3.2914                 5.7307 ]
                         :         C_pi_BS_ip_xy:             0.00048505                0.98998   [                -3.3989                 5.7307 ]
                         :  C_Ds_vertex_2DSig_BS:              0.0047030                0.99764   [                -3.2682                 5.7307 ]
                         : ----------------------------------------------------------------------------------------------------------------------------
TFHandler_PyKeras        :              Variable                     Mean                     RMS             [        Min                     Max ]
                         : ----------------------------------------------------------------------------------------------------------------------------
                         : C_Hnl_vertex_2DSig_BS:               0.012060                0.97596   [                -3.2904                 5.7307 ]
                         :    C_Hnl_vertex_cos2D:              0.0054665                0.99893   [                -3.2914                 5.7307 ]
                         :         C_pi_BS_ip_xy:             0.00048505                0.98998   [                -3.3989                 5.7307 ]
                         :  C_Ds_vertex_2DSig_BS:              0.0047030                0.99764   [                -3.2682                 5.7307 ]
                         : ----------------------------------------------------------------------------------------------------------------------------
                         : Split TMVA training data in 319274 training events and 79818 validation events
                         : Training Model Summary
running TMVA for signal mN1p0_ctau10
keras_par_string: H:!V:VarTransform=D,G:FilenameModel=TMVA_keras_models/keras_shallow_model_old_TMVA.h5:FilenameTrainedModel=TMVA_keras_models/keras_shallow_model_old_TMVA_trained_model.h5:NumEpochs=5:BatchSize=64:Verbose=1
dealing with signal mN1p0_ctau10
signal file name: /home/quibus/hnl_ntuples_for_mva/tree_HnlToMuPi_prompt_DsToNMu_NToMuPi_SoftQCDnonD_noQuarkFilter_mN1p0_ctau10p0mm_TuneCP5_13TeV-pythia8-evtgen_tree_new.root
factory_string: !V:!Silent:Color:DrawProgressBar:Transformations=D,G:AnalysisType=Classification
Model: "sequential_1"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 normalization_1 (Normalizat  (None, 4)                9         
 ion)                                                            
                                                                 
 dense_2 (Dense)             (None, 64)                320       
                                                                 
 dense_3 (Dense)             (None, 2)                 130       
                                                                 
=================================================================
Total params: 459
Trainable params: 450
Non-trainable params: 9
_________________________________________________________________
                         : Option SaveBestOnly: Only model weights with smallest validation loss will be stored
Epoch 1/5
   1/4989 [..............................] - ETA: 30:54 - loss: 0.0284 - accuracy: 0.4084  25/4989 [..............................] - ETA: 10s - loss: 0.0252 - accuracy: 0.5562    78/4989 [..............................] - ETA: 6s - loss: 0.0237 - accuracy: 0.7708  130/4989 [..............................] - ETA: 5s - loss: 0.0218 - accuracy: 0.8224 180/4989 [>.............................] - ETA: 5s - loss: 0.0196 - accuracy: 0.8587 234/4989 [>.............................] - ETA: 5s - loss: 0.0177 - accuracy: 0.8720 290/4989 [>.............................] - ETA: 4s - loss: 0.0160 - accuracy: 0.8848 343/4989 [=>............................] - ETA: 4s - loss: 0.0148 - accuracy: 0.8932 397/4989 [=>............................] - ETA: 4s - loss: 0.0139 - accuracy: 0.8978 450/4989 [=>............................] - ETA: 4s - loss: 0.0131 - accuracy: 0.9034 503/4989 [==>...........................] - ETA: 4s - loss: 0.0123 - accuracy: 0.9069 557/4989 [==>...........................] - ETA: 4s - loss: 0.0118 - accuracy: 0.9095 609/4989 [==>...........................] - ETA: 4s - loss: 0.0114 - accuracy: 0.9124 663/4989 [==>...........................] - ETA: 4s - loss: 0.0112 - accuracy: 0.9146 717/4989 [===>..........................] - ETA: 4s - loss: 0.0107 - accuracy: 0.9184 770/4989 [===>..........................] - ETA: 4s - loss: 0.0104 - accuracy: 0.9190 822/4989 [===>..........................] - ETA: 4s - loss: 0.0102 - accuracy: 0.9191 875/4989 [====>.........................] - ETA: 4s - loss: 0.0100 - accuracy: 0.9196 928/4989 [====>.........................] - ETA: 3s - loss: 0.0098 - accuracy: 0.9199 981/4989 [====>.........................] - ETA: 3s - loss: 0.0096 - accuracy: 0.92101036/4989 [=====>........................] - ETA: 3s - loss: 0.0094 - accuracy: 0.92141090/4989 [=====>........................] - ETA: 3s - loss: 0.0093 - accuracy: 0.92211144/4989 [=====>........................] - ETA: 3s - loss: 0.0092 - accuracy: 0.92271196/4989 [======>.......................] - ETA: 3s - loss: 0.0091 - accuracy: 0.92311249/4989 [======>.......................] - ETA: 3s - loss: 0.0090 - accuracy: 0.92351302/4989 [======>.......................] - ETA: 3s - loss: 0.0089 - accuracy: 0.92461355/4989 [=======>......................] - ETA: 3s - loss: 0.0087 - accuracy: 0.92521408/4989 [=======>......................] - ETA: 3s - loss: 0.0085 - accuracy: 0.92641462/4989 [=======>......................] - ETA: 3s - loss: 0.0085 - accuracy: 0.92771515/4989 [========>.....................] - ETA: 3s - loss: 0.0083 - accuracy: 0.92851568/4989 [========>.....................] - ETA: 3s - loss: 0.0082 - accuracy: 0.92891622/4989 [========>.....................] - ETA: 3s - loss: 0.0080 - accuracy: 0.93041676/4989 [=========>....................] - ETA: 3s - loss: 0.0079 - accuracy: 0.93161730/4989 [=========>....................] - ETA: 3s - loss: 0.0079 - accuracy: 0.93171784/4989 [=========>....................] - ETA: 3s - loss: 0.0079 - accuracy: 0.93151837/4989 [==========>...................] - ETA: 3s - loss: 0.0078 - accuracy: 0.93231889/4989 [==========>...................] - ETA: 2s - loss: 0.0077 - accuracy: 0.93331940/4989 [==========>...................] - ETA: 2s - loss: 0.0076 - accuracy: 0.93451995/4989 [==========>...................] - ETA: 2s - loss: 0.0075 - accuracy: 0.93462047/4989 [===========>..................] - ETA: 2s - loss: 0.0076 - accuracy: 0.93392102/4989 [===========>..................] - ETA: 2s - loss: 0.0075 - accuracy: 0.93452154/4989 [===========>..................] - ETA: 2s - loss: 0.0074 - accuracy: 0.93502209/4989 [============>.................] - ETA: 2s - loss: 0.0073 - accuracy: 0.93522262/4989 [============>.................] - ETA: 2s - loss: 0.0074 - accuracy: 0.93512314/4989 [============>.................] - ETA: 2s - loss: 0.0073 - accuracy: 0.93522367/4989 [=============>................] - ETA: 2s - loss: 0.0073 - accuracy: 0.93572420/4989 [=============>................] - ETA: 2s - loss: 0.0072 - accuracy: 0.93612473/4989 [=============>................] - ETA: 2s - loss: 0.0072 - accuracy: 0.93642527/4989 [==============>...............] - ETA: 2s - loss: 0.0071 - accuracy: 0.93662581/4989 [==============>...............] - ETA: 2s - loss: 0.0071 - accuracy: 0.93692636/4989 [==============>...............] - ETA: 2s - loss: 0.0070 - accuracy: 0.93702688/4989 [===============>..............] - ETA: 2s - loss: 0.0070 - accuracy: 0.93752744/4989 [===============>..............] - ETA: 2s - loss: 0.0070 - accuracy: 0.93792797/4989 [===============>..............] - ETA: 2s - loss: 0.0069 - accuracy: 0.93832851/4989 [================>.............] - ETA: 2s - loss: 0.0069 - accuracy: 0.93882903/4989 [================>.............] - ETA: 1s - loss: 0.0068 - accuracy: 0.93862955/4989 [================>.............] - ETA: 1s - loss: 0.0068 - accuracy: 0.93873004/4989 [=================>............] - ETA: 1s - loss: 0.0068 - accuracy: 0.93853057/4989 [=================>............] - ETA: 1s - loss: 0.0068 - accuracy: 0.93863111/4989 [=================>............] - ETA: 1s - loss: 0.0068 - accuracy: 0.93903165/4989 [==================>...........] - ETA: 1s - loss: 0.0067 - accuracy: 0.93913216/4989 [==================>...........] - ETA: 1s - loss: 0.0067 - accuracy: 0.93953268/4989 [==================>...........] - ETA: 1s - loss: 0.0067 - accuracy: 0.93993321/4989 [==================>...........] - ETA: 1s - loss: 0.0067 - accuracy: 0.93983373/4989 [===================>..........] - ETA: 1s - loss: 0.0067 - accuracy: 0.93993423/4989 [===================>..........] - ETA: 1s - loss: 0.0067 - accuracy: 0.93983464/4989 [===================>..........] - ETA: 1s - loss: 0.0066 - accuracy: 0.93973505/4989 [====================>.........] - ETA: 1s - loss: 0.0066 - accuracy: 0.93973545/4989 [====================>.........] - ETA: 1s - loss: 0.0066 - accuracy: 0.93983586/4989 [====================>.........] - ETA: 1s - loss: 0.0066 - accuracy: 0.93963628/4989 [====================>.........] - ETA: 1s - loss: 0.0066 - accuracy: 0.93963681/4989 [=====================>........] - ETA: 1s - loss: 0.0066 - accuracy: 0.93993735/4989 [=====================>........] - ETA: 1s - loss: 0.0066 - accuracy: 0.94023790/4989 [=====================>........] - ETA: 1s - loss: 0.0065 - accuracy: 0.94033844/4989 [======================>.......] - ETA: 1s - loss: 0.0065 - accuracy: 0.94033899/4989 [======================>.......] - ETA: 1s - loss: 0.0065 - accuracy: 0.94053953/4989 [======================>.......] - ETA: 1s - loss: 0.0065 - accuracy: 0.94044006/4989 [=======================>......] - ETA: 0s - loss: 0.0065 - accuracy: 0.94064060/4989 [=======================>......] - ETA: 0s - loss: 0.0065 - accuracy: 0.94024115/4989 [=======================>......] - ETA: 0s - loss: 0.0065 - accuracy: 0.94014168/4989 [========================>.....] - ETA: 0s - loss: 0.0065 - accuracy: 0.94034223/4989 [========================>.....] - ETA: 0s - loss: 0.0065 - accuracy: 0.94044278/4989 [========================>.....] - ETA: 0s - loss: 0.0065 - accuracy: 0.94034328/4989 [=========================>....] - ETA: 0s - loss: 0.0065 - accuracy: 0.94004384/4989 [=========================>....] - ETA: 0s - loss: 0.0065 - accuracy: 0.94024439/4989 [=========================>....] - ETA: 0s - loss: 0.0065 - accuracy: 0.94024494/4989 [==========================>...] - ETA: 0s - loss: 0.0065 - accuracy: 0.94064547/4989 [==========================>...] - ETA: 0s - loss: 0.0065 - accuracy: 0.94034601/4989 [==========================>...] - ETA: 0s - loss: 0.0065 - accuracy: 0.94054655/4989 [==========================>...] - ETA: 0s - loss: 0.0065 - accuracy: 0.94094708/4989 [===========================>..] - ETA: 0s - loss: 0.0064 - accuracy: 0.94104761/4989 [===========================>..] - ETA: 0s - loss: 0.0064 - accuracy: 0.94094812/4989 [===========================>..] - ETA: 0s - loss: 0.0064 - accuracy: 0.94094866/4989 [============================>.] - ETA: 0s - loss: 0.0064 - accuracy: 0.94074920/4989 [============================>.] - ETA: 0s - loss: 0.0064 - accuracy: 0.94074973/4989 [============================>.] - ETA: 0s - loss: 0.0064 - accuracy: 0.9410
Epoch 1: val_loss improved from inf to 0.00580, saving model to TMVA_keras_models/keras_shallow_model_old_TMVA_trained_model.h5
4989/4989 [==============================] - 20s 4ms/step - loss: 0.0064 - accuracy: 0.9411 - val_loss: 0.0058 - val_accuracy: 0.9463
Epoch 2/5
   1/4989 [..............................] - ETA: 6s - loss: 0.0039 - accuracy: 0.9540  54/4989 [..............................] - ETA: 4s - loss: 0.0046 - accuracy: 0.9535 107/4989 [..............................] - ETA: 4s - loss: 0.0047 - accuracy: 0.9574 161/4989 [..............................] - ETA: 4s - loss: 0.0055 - accuracy: 0.9487 215/4989 [>.............................] - ETA: 4s - loss: 0.0062 - accuracy: 0.9389 269/4989 [>.............................] - ETA: 4s - loss: 0.0061 - accuracy: 0.9375 322/4989 [>.............................] - ETA: 4s - loss: 0.0057 - accuracy: 0.9405 376/4989 [=>............................] - ETA: 4s - loss: 0.0057 - accuracy: 0.9417 431/4989 [=>............................] - ETA: 4s - loss: 0.0060 - accuracy: 0.9391 486/4989 [=>............................] - ETA: 4s - loss: 0.0059 - accuracy: 0.9411 540/4989 [==>...........................] - ETA: 4s - loss: 0.0058 - accuracy: 0.9415 595/4989 [==>...........................] - ETA: 4s - loss: 0.0057 - accuracy: 0.9412 650/4989 [==>...........................] - ETA: 4s - loss: 0.0056 - accuracy: 0.9425 705/4989 [===>..........................] - ETA: 3s - loss: 0.0054 - accuracy: 0.9435 758/4989 [===>..........................] - ETA: 3s - loss: 0.0055 - accuracy: 0.9433 813/4989 [===>..........................] - ETA: 3s - loss: 0.0056 - accuracy: 0.9423 867/4989 [====>.........................] - ETA: 3s - loss: 0.0057 - accuracy: 0.9412 920/4989 [====>.........................] - ETA: 3s - loss: 0.0057 - accuracy: 0.9415 974/4989 [====>.........................] - ETA: 3s - loss: 0.0056 - accuracy: 0.94351029/4989 [=====>........................] - ETA: 3s - loss: 0.0056 - accuracy: 0.94381082/4989 [=====>........................] - ETA: 3s - loss: 0.0056 - accuracy: 0.94481137/4989 [=====>........................] - ETA: 3s - loss: 0.0056 - accuracy: 0.94391191/4989 [======>.......................] - ETA: 3s - loss: 0.0055 - accuracy: 0.94491245/4989 [======>.......................] - ETA: 3s - loss: 0.0054 - accuracy: 0.94561297/4989 [======>.......................] - ETA: 3s - loss: 0.0054 - accuracy: 0.94631352/4989 [=======>......................] - ETA: 3s - loss: 0.0054 - accuracy: 0.94691406/4989 [=======>......................] - ETA: 3s - loss: 0.0054 - accuracy: 0.94751461/4989 [=======>......................] - ETA: 3s - loss: 0.0053 - accuracy: 0.94731516/4989 [========>.....................] - ETA: 3s - loss: 0.0053 - accuracy: 0.94791570/4989 [========>.....................] - ETA: 3s - loss: 0.0054 - accuracy: 0.94741623/4989 [========>.....................] - ETA: 3s - loss: 0.0053 - accuracy: 0.94751675/4989 [=========>....................] - ETA: 3s - loss: 0.0054 - accuracy: 0.94691725/4989 [=========>....................] - ETA: 3s - loss: 0.0056 - accuracy: 0.94571778/4989 [=========>....................] - ETA: 3s - loss: 0.0055 - accuracy: 0.94591831/4989 [==========>...................] - ETA: 2s - loss: 0.0056 - accuracy: 0.94551885/4989 [==========>...................] - ETA: 2s - loss: 0.0056 - accuracy: 0.94521938/4989 [==========>...................] - ETA: 2s - loss: 0.0056 - accuracy: 0.94541993/4989 [==========>...................] - ETA: 2s - loss: 0.0056 - accuracy: 0.94462046/4989 [===========>..................] - ETA: 2s - loss: 0.0056 - accuracy: 0.94482100/4989 [===========>..................] - ETA: 2s - loss: 0.0056 - accuracy: 0.94522152/4989 [===========>..................] - ETA: 2s - loss: 0.0055 - accuracy: 0.94562207/4989 [============>.................] - ETA: 2s - loss: 0.0055 - accuracy: 0.94602261/4989 [============>.................] - ETA: 2s - loss: 0.0055 - accuracy: 0.94652315/4989 [============>.................] - ETA: 2s - loss: 0.0054 - accuracy: 0.94712368/4989 [=============>................] - ETA: 2s - loss: 0.0055 - accuracy: 0.94692421/4989 [=============>................] - ETA: 2s - loss: 0.0055 - accuracy: 0.94722476/4989 [=============>................] - ETA: 2s - loss: 0.0055 - accuracy: 0.94742529/4989 [==============>...............] - ETA: 2s - loss: 0.0055 - accuracy: 0.94772581/4989 [==============>...............] - ETA: 2s - loss: 0.0055 - accuracy: 0.94782635/4989 [==============>...............] - ETA: 2s - loss: 0.0055 - accuracy: 0.94772688/4989 [===============>..............] - ETA: 2s - loss: 0.0055 - accuracy: 0.94772742/4989 [===============>..............] - ETA: 2s - loss: 0.0055 - accuracy: 0.94792797/4989 [===============>..............] - ETA: 2s - loss: 0.0055 - accuracy: 0.94742851/4989 [================>.............] - ETA: 2s - loss: 0.0055 - accuracy: 0.94722904/4989 [================>.............] - ETA: 1s - loss: 0.0055 - accuracy: 0.94722959/4989 [================>.............] - ETA: 1s - loss: 0.0055 - accuracy: 0.94733013/4989 [=================>............] - ETA: 1s - loss: 0.0055 - accuracy: 0.94753065/4989 [=================>............] - ETA: 1s - loss: 0.0055 - accuracy: 0.94753119/4989 [=================>............] - ETA: 1s - loss: 0.0055 - accuracy: 0.94723173/4989 [==================>...........] - ETA: 1s - loss: 0.0056 - accuracy: 0.94693227/4989 [==================>...........] - ETA: 1s - loss: 0.0056 - accuracy: 0.94693280/4989 [==================>...........] - ETA: 1s - loss: 0.0056 - accuracy: 0.94693334/4989 [===================>..........] - ETA: 1s - loss: 0.0056 - accuracy: 0.94703388/4989 [===================>..........] - ETA: 1s - loss: 0.0056 - accuracy: 0.94683441/4989 [===================>..........] - ETA: 1s - loss: 0.0055 - accuracy: 0.94723495/4989 [====================>.........] - ETA: 1s - loss: 0.0055 - accuracy: 0.94733548/4989 [====================>.........] - ETA: 1s - loss: 0.0055 - accuracy: 0.94753602/4989 [====================>.........] - ETA: 1s - loss: 0.0055 - accuracy: 0.94753655/4989 [====================>.........] - ETA: 1s - loss: 0.0055 - accuracy: 0.94783709/4989 [=====================>........] - ETA: 1s - loss: 0.0055 - accuracy: 0.94753762/4989 [=====================>........] - ETA: 1s - loss: 0.0055 - accuracy: 0.94773816/4989 [=====================>........] - ETA: 1s - loss: 0.0055 - accuracy: 0.94793869/4989 [======================>.......] - ETA: 1s - loss: 0.0055 - accuracy: 0.94783923/4989 [======================>.......] - ETA: 1s - loss: 0.0055 - accuracy: 0.94783976/4989 [======================>.......] - ETA: 0s - loss: 0.0055 - accuracy: 0.94774029/4989 [=======================>......] - ETA: 0s - loss: 0.0054 - accuracy: 0.94784083/4989 [=======================>......] - ETA: 0s - loss: 0.0054 - accuracy: 0.94774137/4989 [=======================>......] - ETA: 0s - loss: 0.0054 - accuracy: 0.94804191/4989 [========================>.....] - ETA: 0s - loss: 0.0054 - accuracy: 0.94774246/4989 [========================>.....] - ETA: 0s - loss: 0.0054 - accuracy: 0.94784297/4989 [========================>.....] - ETA: 0s - loss: 0.0054 - accuracy: 0.94784351/4989 [=========================>....] - ETA: 0s - loss: 0.0054 - accuracy: 0.94754404/4989 [=========================>....] - ETA: 0s - loss: 0.0054 - accuracy: 0.94744458/4989 [=========================>....] - ETA: 0s - loss: 0.0054 - accuracy: 0.94774513/4989 [==========================>...] - ETA: 0s - loss: 0.0054 - accuracy: 0.94784565/4989 [==========================>...] - ETA: 0s - loss: 0.0054 - accuracy: 0.94804618/4989 [==========================>...] - ETA: 0s - loss: 0.0055 - accuracy: 0.94814671/4989 [===========================>..] - ETA: 0s - loss: 0.0054 - accuracy: 0.94844726/4989 [===========================>..] - ETA: 0s - loss: 0.0054 - accuracy: 0.94844776/4989 [===========================>..] - ETA: 0s - loss: 0.0054 - accuracy: 0.94864828/4989 [============================>.] - ETA: 0s - loss: 0.0054 - accuracy: 0.94854882/4989 [============================>.] - ETA: 0s - loss: 0.0055 - accuracy: 0.94814937/4989 [============================>.] - ETA: 0s - loss: 0.0054 - accuracy: 0.94814989/4989 [==============================] - ETA: 0s - loss: 0.0055 - accuracy: 0.9479
Epoch 2: val_loss improved from 0.00580 to 0.00578, saving model to TMVA_keras_models/keras_shallow_model_old_TMVA_trained_model.h5
4989/4989 [==============================] - 6s 1ms/step - loss: 0.0055 - accuracy: 0.9479 - val_loss: 0.0058 - val_accuracy: 0.9451
Epoch 3/5
   1/4989 [..............................] - ETA: 6s - loss: 0.0024 - accuracy: 0.9867  53/4989 [..............................] - ETA: 4s - loss: 0.0055 - accuracy: 0.9536 104/4989 [..............................] - ETA: 4s - loss: 0.0054 - accuracy: 0.9453 157/4989 [..............................] - ETA: 4s - loss: 0.0049 - accuracy: 0.9544 209/4989 [>.............................] - ETA: 4s - loss: 0.0052 - accuracy: 0.9534 263/4989 [>.............................] - ETA: 4s - loss: 0.0051 - accuracy: 0.9553 317/4989 [>.............................] - ETA: 4s - loss: 0.0048 - accuracy: 0.9552 369/4989 [=>............................] - ETA: 4s - loss: 0.0049 - accuracy: 0.9535 421/4989 [=>............................] - ETA: 4s - loss: 0.0050 - accuracy: 0.9529 474/4989 [=>............................] - ETA: 4s - loss: 0.0049 - accuracy: 0.9534 527/4989 [==>...........................] - ETA: 4s - loss: 0.0051 - accuracy: 0.9521 581/4989 [==>...........................] - ETA: 4s - loss: 0.0051 - accuracy: 0.9527 635/4989 [==>...........................] - ETA: 4s - loss: 0.0051 - accuracy: 0.9522 691/4989 [===>..........................] - ETA: 4s - loss: 0.0052 - accuracy: 0.9519 745/4989 [===>..........................] - ETA: 4s - loss: 0.0052 - accuracy: 0.9509 800/4989 [===>..........................] - ETA: 3s - loss: 0.0054 - accuracy: 0.9494 854/4989 [====>.........................] - ETA: 3s - loss: 0.0055 - accuracy: 0.9492 909/4989 [====>.........................] - ETA: 3s - loss: 0.0055 - accuracy: 0.9484 962/4989 [====>.........................] - ETA: 3s - loss: 0.0057 - accuracy: 0.94561016/4989 [=====>........................] - ETA: 3s - loss: 0.0056 - accuracy: 0.94621071/4989 [=====>........................] - ETA: 3s - loss: 0.0056 - accuracy: 0.94651126/4989 [=====>........................] - ETA: 3s - loss: 0.0057 - accuracy: 0.94601180/4989 [======>.......................] - ETA: 3s - loss: 0.0057 - accuracy: 0.94591234/4989 [======>.......................] - ETA: 3s - loss: 0.0057 - accuracy: 0.94611289/4989 [======>.......................] - ETA: 3s - loss: 0.0058 - accuracy: 0.94491343/4989 [=======>......................] - ETA: 3s - loss: 0.0058 - accuracy: 0.94391395/4989 [=======>......................] - ETA: 3s - loss: 0.0057 - accuracy: 0.94481448/4989 [=======>......................] - ETA: 3s - loss: 0.0057 - accuracy: 0.94521503/4989 [========>.....................] - ETA: 3s - loss: 0.0056 - accuracy: 0.94551558/4989 [========>.....................] - ETA: 3s - loss: 0.0056 - accuracy: 0.94591611/4989 [========>.....................] - ETA: 3s - loss: 0.0057 - accuracy: 0.94451664/4989 [=========>....................] - ETA: 3s - loss: 0.0056 - accuracy: 0.94491718/4989 [=========>....................] - ETA: 3s - loss: 0.0057 - accuracy: 0.94451773/4989 [=========>....................] - ETA: 3s - loss: 0.0057 - accuracy: 0.94441825/4989 [=========>....................] - ETA: 2s - loss: 0.0056 - accuracy: 0.94491877/4989 [==========>...................] - ETA: 2s - loss: 0.0056 - accuracy: 0.94531932/4989 [==========>...................] - ETA: 2s - loss: 0.0056 - accuracy: 0.94541986/4989 [==========>...................] - ETA: 2s - loss: 0.0056 - accuracy: 0.94542041/4989 [===========>..................] - ETA: 2s - loss: 0.0056 - accuracy: 0.94482094/4989 [===========>..................] - ETA: 2s - loss: 0.0057 - accuracy: 0.94512148/4989 [===========>..................] - ETA: 2s - loss: 0.0057 - accuracy: 0.94482200/4989 [============>.................] - ETA: 2s - loss: 0.0057 - accuracy: 0.94532255/4989 [============>.................] - ETA: 2s - loss: 0.0057 - accuracy: 0.94512308/4989 [============>.................] - ETA: 2s - loss: 0.0057 - accuracy: 0.94532362/4989 [=============>................] - ETA: 2s - loss: 0.0056 - accuracy: 0.94572416/4989 [=============>................] - ETA: 2s - loss: 0.0056 - accuracy: 0.94622471/4989 [=============>................] - ETA: 2s - loss: 0.0056 - accuracy: 0.94612524/4989 [==============>...............] - ETA: 2s - loss: 0.0056 - accuracy: 0.94592577/4989 [==============>...............] - ETA: 2s - loss: 0.0056 - accuracy: 0.94602630/4989 [==============>...............] - ETA: 2s - loss: 0.0056 - accuracy: 0.94592685/4989 [===============>..............] - ETA: 2s - loss: 0.0056 - accuracy: 0.94612739/4989 [===============>..............] - ETA: 2s - loss: 0.0056 - accuracy: 0.94602792/4989 [===============>..............] - ETA: 2s - loss: 0.0055 - accuracy: 0.94652845/4989 [================>.............] - ETA: 2s - loss: 0.0055 - accuracy: 0.94692899/4989 [================>.............] - ETA: 1s - loss: 0.0055 - accuracy: 0.94702952/4989 [================>.............] - ETA: 1s - loss: 0.0055 - accuracy: 0.94663007/4989 [=================>............] - ETA: 1s - loss: 0.0055 - accuracy: 0.94693059/4989 [=================>............] - ETA: 1s - loss: 0.0055 - accuracy: 0.94693114/4989 [=================>............] - ETA: 1s - loss: 0.0055 - accuracy: 0.94683167/4989 [==================>...........] - ETA: 1s - loss: 0.0055 - accuracy: 0.94683220/4989 [==================>...........] - ETA: 1s - loss: 0.0055 - accuracy: 0.94683272/4989 [==================>...........] - ETA: 1s - loss: 0.0056 - accuracy: 0.94683328/4989 [===================>..........] - ETA: 1s - loss: 0.0055 - accuracy: 0.94713382/4989 [===================>..........] - ETA: 1s - loss: 0.0056 - accuracy: 0.94703437/4989 [===================>..........] - ETA: 1s - loss: 0.0056 - accuracy: 0.94683493/4989 [====================>.........] - ETA: 1s - loss: 0.0056 - accuracy: 0.94673550/4989 [====================>.........] - ETA: 1s - loss: 0.0056 - accuracy: 0.94673605/4989 [====================>.........] - ETA: 1s - loss: 0.0056 - accuracy: 0.94673662/4989 [=====================>........] - ETA: 1s - loss: 0.0056 - accuracy: 0.94703716/4989 [=====================>........] - ETA: 1s - loss: 0.0056 - accuracy: 0.94713771/4989 [=====================>........] - ETA: 1s - loss: 0.0056 - accuracy: 0.94723824/4989 [=====================>........] - ETA: 1s - loss: 0.0056 - accuracy: 0.94713877/4989 [======================>.......] - ETA: 1s - loss: 0.0056 - accuracy: 0.94723930/4989 [======================>.......] - ETA: 0s - loss: 0.0056 - accuracy: 0.94723983/4989 [======================>.......] - ETA: 0s - loss: 0.0056 - accuracy: 0.94704035/4989 [=======================>......] - ETA: 0s - loss: 0.0056 - accuracy: 0.94714088/4989 [=======================>......] - ETA: 0s - loss: 0.0056 - accuracy: 0.94704141/4989 [=======================>......] - ETA: 0s - loss: 0.0056 - accuracy: 0.94704195/4989 [========================>.....] - ETA: 0s - loss: 0.0056 - accuracy: 0.94704248/4989 [========================>.....] - ETA: 0s - loss: 0.0056 - accuracy: 0.94684303/4989 [========================>.....] - ETA: 0s - loss: 0.0055 - accuracy: 0.94674356/4989 [=========================>....] - ETA: 0s - loss: 0.0055 - accuracy: 0.94714409/4989 [=========================>....] - ETA: 0s - loss: 0.0055 - accuracy: 0.94714460/4989 [=========================>....] - ETA: 0s - loss: 0.0055 - accuracy: 0.94744513/4989 [==========================>...] - ETA: 0s - loss: 0.0055 - accuracy: 0.94754565/4989 [==========================>...] - ETA: 0s - loss: 0.0055 - accuracy: 0.94774618/4989 [==========================>...] - ETA: 0s - loss: 0.0054 - accuracy: 0.94784672/4989 [===========================>..] - ETA: 0s - loss: 0.0054 - accuracy: 0.94794726/4989 [===========================>..] - ETA: 0s - loss: 0.0054 - accuracy: 0.94784779/4989 [===========================>..] - ETA: 0s - loss: 0.0054 - accuracy: 0.94804833/4989 [============================>.] - ETA: 0s - loss: 0.0054 - accuracy: 0.94824887/4989 [============================>.] - ETA: 0s - loss: 0.0054 - accuracy: 0.94834941/4989 [============================>.] - ETA: 0s - loss: 0.0054 - accuracy: 0.9481
Epoch 3: val_loss improved from 0.00578 to 0.00573, saving model to TMVA_keras_models/keras_shallow_model_old_TMVA_trained_model.h5
4989/4989 [==============================] - 6s 1ms/step - loss: 0.0054 - accuracy: 0.9480 - val_loss: 0.0057 - val_accuracy: 0.9476
Epoch 4/5
   1/4989 [..............................] - ETA: 7s - loss: 0.0033 - accuracy: 0.9520  51/4989 [..............................] - ETA: 4s - loss: 0.0052 - accuracy: 0.9561 103/4989 [..............................] - ETA: 4s - loss: 0.0055 - accuracy: 0.9497 157/4989 [..............................] - ETA: 4s - loss: 0.0065 - accuracy: 0.9345 211/4989 [>.............................] - ETA: 4s - loss: 0.0064 - accuracy: 0.9381 266/4989 [>.............................] - ETA: 4s - loss: 0.0058 - accuracy: 0.9416 319/4989 [>.............................] - ETA: 4s - loss: 0.0055 - accuracy: 0.9430 372/4989 [=>............................] - ETA: 4s - loss: 0.0054 - accuracy: 0.9458 425/4989 [=>............................] - ETA: 4s - loss: 0.0054 - accuracy: 0.9446 478/4989 [=>............................] - ETA: 4s - loss: 0.0056 - accuracy: 0.9426 510/4989 [==>...........................] - ETA: 4s - loss: 0.0055 - accuracy: 0.9447 542/4989 [==>...........................] - ETA: 4s - loss: 0.0054 - accuracy: 0.9454 595/4989 [==>...........................] - ETA: 4s - loss: 0.0054 - accuracy: 0.9453 650/4989 [==>...........................] - ETA: 4s - loss: 0.0055 - accuracy: 0.9462 703/4989 [===>..........................] - ETA: 4s - loss: 0.0054 - accuracy: 0.9459 759/4989 [===>..........................] - ETA: 4s - loss: 0.0056 - accuracy: 0.9450 812/4989 [===>..........................] - ETA: 4s - loss: 0.0056 - accuracy: 0.9461 866/4989 [====>.........................] - ETA: 4s - loss: 0.0056 - accuracy: 0.9465 921/4989 [====>.........................] - ETA: 4s - loss: 0.0056 - accuracy: 0.9460 977/4989 [====>.........................] - ETA: 3s - loss: 0.0056 - accuracy: 0.94681030/4989 [=====>........................] - ETA: 3s - loss: 0.0056 - accuracy: 0.94621086/4989 [=====>........................] - ETA: 3s - loss: 0.0056 - accuracy: 0.94661136/4989 [=====>........................] - ETA: 3s - loss: 0.0057 - accuracy: 0.94601192/4989 [======>.......................] - ETA: 3s - loss: 0.0056 - accuracy: 0.94711245/4989 [======>.......................] - ETA: 3s - loss: 0.0057 - accuracy: 0.94671298/4989 [======>.......................] - ETA: 3s - loss: 0.0056 - accuracy: 0.94731353/4989 [=======>......................] - ETA: 3s - loss: 0.0057 - accuracy: 0.94621409/4989 [=======>......................] - ETA: 3s - loss: 0.0057 - accuracy: 0.94661460/4989 [=======>......................] - ETA: 3s - loss: 0.0058 - accuracy: 0.94581513/4989 [========>.....................] - ETA: 3s - loss: 0.0057 - accuracy: 0.94561569/4989 [========>.....................] - ETA: 3s - loss: 0.0057 - accuracy: 0.94531622/4989 [========>.....................] - ETA: 3s - loss: 0.0056 - accuracy: 0.94591677/4989 [=========>....................] - ETA: 3s - loss: 0.0056 - accuracy: 0.94591730/4989 [=========>....................] - ETA: 3s - loss: 0.0055 - accuracy: 0.94641784/4989 [=========>....................] - ETA: 3s - loss: 0.0056 - accuracy: 0.94581838/4989 [==========>...................] - ETA: 3s - loss: 0.0055 - accuracy: 0.94611890/4989 [==========>...................] - ETA: 2s - loss: 0.0056 - accuracy: 0.94601943/4989 [==========>...................] - ETA: 2s - loss: 0.0055 - accuracy: 0.94681997/4989 [===========>..................] - ETA: 2s - loss: 0.0056 - accuracy: 0.94622051/4989 [===========>..................] - ETA: 2s - loss: 0.0056 - accuracy: 0.94632106/4989 [===========>..................] - ETA: 2s - loss: 0.0056 - accuracy: 0.94572158/4989 [===========>..................] - ETA: 2s - loss: 0.0056 - accuracy: 0.94612212/4989 [============>.................] - ETA: 2s - loss: 0.0056 - accuracy: 0.94632267/4989 [============>.................] - ETA: 2s - loss: 0.0056 - accuracy: 0.94622321/4989 [============>.................] - ETA: 2s - loss: 0.0057 - accuracy: 0.94582377/4989 [=============>................] - ETA: 2s - loss: 0.0057 - accuracy: 0.94572431/4989 [=============>................] - ETA: 2s - loss: 0.0057 - accuracy: 0.94532481/4989 [=============>................] - ETA: 2s - loss: 0.0058 - accuracy: 0.94512517/4989 [==============>...............] - ETA: 2s - loss: 0.0057 - accuracy: 0.94552556/4989 [==============>...............] - ETA: 2s - loss: 0.0057 - accuracy: 0.94522595/4989 [==============>...............] - ETA: 2s - loss: 0.0057 - accuracy: 0.94532640/4989 [==============>...............] - ETA: 2s - loss: 0.0057 - accuracy: 0.94512677/4989 [===============>..............] - ETA: 2s - loss: 0.0057 - accuracy: 0.94552725/4989 [===============>..............] - ETA: 2s - loss: 0.0057 - accuracy: 0.94582775/4989 [===============>..............] - ETA: 2s - loss: 0.0057 - accuracy: 0.94582824/4989 [===============>..............] - ETA: 2s - loss: 0.0057 - accuracy: 0.94592873/4989 [================>.............] - ETA: 2s - loss: 0.0057 - accuracy: 0.94572923/4989 [================>.............] - ETA: 2s - loss: 0.0057 - accuracy: 0.94552973/4989 [================>.............] - ETA: 1s - loss: 0.0057 - accuracy: 0.94583023/4989 [=================>............] - ETA: 1s - loss: 0.0057 - accuracy: 0.94603072/4989 [=================>............] - ETA: 1s - loss: 0.0057 - accuracy: 0.94573122/4989 [=================>............] - ETA: 1s - loss: 0.0057 - accuracy: 0.94573170/4989 [==================>...........] - ETA: 1s - loss: 0.0057 - accuracy: 0.94593218/4989 [==================>...........] - ETA: 1s - loss: 0.0057 - accuracy: 0.94573267/4989 [==================>...........] - ETA: 1s - loss: 0.0056 - accuracy: 0.94573319/4989 [==================>...........] - ETA: 1s - loss: 0.0056 - accuracy: 0.94593370/4989 [===================>..........] - ETA: 1s - loss: 0.0056 - accuracy: 0.94653422/4989 [===================>..........] - ETA: 1s - loss: 0.0056 - accuracy: 0.94693470/4989 [===================>..........] - ETA: 1s - loss: 0.0055 - accuracy: 0.94693522/4989 [====================>.........] - ETA: 1s - loss: 0.0055 - accuracy: 0.94713573/4989 [====================>.........] - ETA: 1s - loss: 0.0055 - accuracy: 0.94693625/4989 [====================>.........] - ETA: 1s - loss: 0.0055 - accuracy: 0.94643677/4989 [=====================>........] - ETA: 1s - loss: 0.0055 - accuracy: 0.94673730/4989 [=====================>........] - ETA: 1s - loss: 0.0055 - accuracy: 0.94673781/4989 [=====================>........] - ETA: 1s - loss: 0.0055 - accuracy: 0.94653832/4989 [======================>.......] - ETA: 1s - loss: 0.0055 - accuracy: 0.94653883/4989 [======================>.......] - ETA: 1s - loss: 0.0055 - accuracy: 0.94673931/4989 [======================>.......] - ETA: 1s - loss: 0.0055 - accuracy: 0.94653977/4989 [======================>.......] - ETA: 1s - loss: 0.0055 - accuracy: 0.94664027/4989 [=======================>......] - ETA: 0s - loss: 0.0054 - accuracy: 0.94684076/4989 [=======================>......] - ETA: 0s - loss: 0.0055 - accuracy: 0.94684128/4989 [=======================>......] - ETA: 0s - loss: 0.0054 - accuracy: 0.94704174/4989 [========================>.....] - ETA: 0s - loss: 0.0054 - accuracy: 0.94714228/4989 [========================>.....] - ETA: 0s - loss: 0.0054 - accuracy: 0.94714278/4989 [========================>.....] - ETA: 0s - loss: 0.0054 - accuracy: 0.94734329/4989 [=========================>....] - ETA: 0s - loss: 0.0054 - accuracy: 0.94744378/4989 [=========================>....] - ETA: 0s - loss: 0.0054 - accuracy: 0.94754431/4989 [=========================>....] - ETA: 0s - loss: 0.0054 - accuracy: 0.94754480/4989 [=========================>....] - ETA: 0s - loss: 0.0054 - accuracy: 0.94764531/4989 [==========================>...] - ETA: 0s - loss: 0.0054 - accuracy: 0.94784579/4989 [==========================>...] - ETA: 0s - loss: 0.0054 - accuracy: 0.94784633/4989 [==========================>...] - ETA: 0s - loss: 0.0054 - accuracy: 0.94794683/4989 [===========================>..] - ETA: 0s - loss: 0.0054 - accuracy: 0.94794736/4989 [===========================>..] - ETA: 0s - loss: 0.0054 - accuracy: 0.94764785/4989 [===========================>..] - ETA: 0s - loss: 0.0054 - accuracy: 0.94774829/4989 [============================>.] - ETA: 0s - loss: 0.0054 - accuracy: 0.94764877/4989 [============================>.] - ETA: 0s - loss: 0.0054 - accuracy: 0.94754924/4989 [============================>.] - ETA: 0s - loss: 0.0054 - accuracy: 0.94754973/4989 [============================>.] - ETA: 0s - loss: 0.0054 - accuracy: 0.9474
Epoch 4: val_loss did not improve from 0.00573
4989/4989 [==============================] - 6s 1ms/step - loss: 0.0054 - accuracy: 0.9474 - val_loss: 0.0058 - val_accuracy: 0.9454
Epoch 5/5
   1/4989 [..............................] - ETA: 5s - loss: 0.0017 - accuracy: 0.9793  38/4989 [..............................] - ETA: 6s - loss: 0.0060 - accuracy: 0.9608  78/4989 [..............................] - ETA: 6s - loss: 0.0053 - accuracy: 0.9663 114/4989 [..............................] - ETA: 6s - loss: 0.0052 - accuracy: 0.9586 149/4989 [..............................] - ETA: 6s - loss: 0.0053 - accuracy: 0.9552 177/4989 [>.............................] - ETA: 6s - loss: 0.0055 - accuracy: 0.9505 206/4989 [>.............................] - ETA: 7s - loss: 0.0055 - accuracy: 0.9495 241/4989 [>.............................] - ETA: 7s - loss: 0.0057 - accuracy: 0.9445 278/4989 [>.............................] - ETA: 6s - loss: 0.0055 - accuracy: 0.9474 316/4989 [>.............................] - ETA: 6s - loss: 0.0053 - accuracy: 0.9494 354/4989 [=>............................] - ETA: 6s - loss: 0.0053 - accuracy: 0.9483 388/4989 [=>............................] - ETA: 6s - loss: 0.0052 - accuracy: 0.9496 431/4989 [=>............................] - ETA: 6s - loss: 0.0051 - accuracy: 0.9511 480/4989 [=>............................] - ETA: 6s - loss: 0.0050 - accuracy: 0.9506 522/4989 [==>...........................] - ETA: 6s - loss: 0.0050 - accuracy: 0.9512 552/4989 [==>...........................] - ETA: 6s - loss: 0.0050 - accuracy: 0.9517 605/4989 [==>...........................] - ETA: 5s - loss: 0.0050 - accuracy: 0.9517 660/4989 [==>...........................] - ETA: 5s - loss: 0.0048 - accuracy: 0.9537 716/4989 [===>..........................] - ETA: 5s - loss: 0.0049 - accuracy: 0.9532 770/4989 [===>..........................] - ETA: 5s - loss: 0.0051 - accuracy: 0.9511 822/4989 [===>..........................] - ETA: 5s - loss: 0.0051 - accuracy: 0.9521 860/4989 [====>.........................] - ETA: 5s - loss: 0.0051 - accuracy: 0.9529 898/4989 [====>.........................] - ETA: 5s - loss: 0.0051 - accuracy: 0.9523 935/4989 [====>.........................] - ETA: 5s - loss: 0.0051 - accuracy: 0.9521 971/4989 [====>.........................] - ETA: 5s - loss: 0.0052 - accuracy: 0.95161012/4989 [=====>........................] - ETA: 4s - loss: 0.0052 - accuracy: 0.95161063/4989 [=====>........................] - ETA: 4s - loss: 0.0052 - accuracy: 0.95161113/4989 [=====>........................] - ETA: 4s - loss: 0.0052 - accuracy: 0.95121165/4989 [======>.......................] - ETA: 4s - loss: 0.0052 - accuracy: 0.95071218/4989 [======>.......................] - ETA: 4s - loss: 0.0052 - accuracy: 0.95131270/4989 [======>.......................] - ETA: 4s - loss: 0.0051 - accuracy: 0.95151322/4989 [======>.......................] - ETA: 4s - loss: 0.0052 - accuracy: 0.95051374/4989 [=======>......................] - ETA: 4s - loss: 0.0052 - accuracy: 0.95001425/4989 [=======>......................] - ETA: 4s - loss: 0.0052 - accuracy: 0.94961477/4989 [=======>......................] - ETA: 4s - loss: 0.0052 - accuracy: 0.94941530/4989 [========>.....................] - ETA: 4s - loss: 0.0052 - accuracy: 0.94941584/4989 [========>.....................] - ETA: 3s - loss: 0.0053 - accuracy: 0.94881629/4989 [========>.....................] - ETA: 3s - loss: 0.0052 - accuracy: 0.94931675/4989 [=========>....................] - ETA: 3s - loss: 0.0052 - accuracy: 0.94891722/4989 [=========>....................] - ETA: 3s - loss: 0.0052 - accuracy: 0.94931770/4989 [=========>....................] - ETA: 3s - loss: 0.0052 - accuracy: 0.94831818/4989 [=========>....................] - ETA: 3s - loss: 0.0052 - accuracy: 0.94791867/4989 [==========>...................] - ETA: 3s - loss: 0.0054 - accuracy: 0.94721917/4989 [==========>...................] - ETA: 3s - loss: 0.0053 - accuracy: 0.94791969/4989 [==========>...................] - ETA: 3s - loss: 0.0054 - accuracy: 0.94722020/4989 [===========>..................] - ETA: 3s - loss: 0.0054 - accuracy: 0.94712066/4989 [===========>..................] - ETA: 3s - loss: 0.0054 - accuracy: 0.94682116/4989 [===========>..................] - ETA: 3s - loss: 0.0053 - accuracy: 0.94732168/4989 [============>.................] - ETA: 3s - loss: 0.0054 - accuracy: 0.94692221/4989 [============>.................] - ETA: 3s - loss: 0.0055 - accuracy: 0.94672269/4989 [============>.................] - ETA: 3s - loss: 0.0055 - accuracy: 0.94672323/4989 [============>.................] - ETA: 2s - loss: 0.0055 - accuracy: 0.94712377/4989 [=============>................] - ETA: 2s - loss: 0.0056 - accuracy: 0.94612429/4989 [=============>................] - ETA: 2s - loss: 0.0055 - accuracy: 0.94622475/4989 [=============>................] - ETA: 2s - loss: 0.0055 - accuracy: 0.94622526/4989 [==============>...............] - ETA: 2s - loss: 0.0055 - accuracy: 0.94602580/4989 [==============>...............] - ETA: 2s - loss: 0.0055 - accuracy: 0.94582628/4989 [==============>...............] - ETA: 2s - loss: 0.0055 - accuracy: 0.94592671/4989 [===============>..............] - ETA: 2s - loss: 0.0055 - accuracy: 0.94572714/4989 [===============>..............] - ETA: 2s - loss: 0.0055 - accuracy: 0.94612761/4989 [===============>..............] - ETA: 2s - loss: 0.0055 - accuracy: 0.94652809/4989 [===============>..............] - ETA: 2s - loss: 0.0055 - accuracy: 0.94602856/4989 [================>.............] - ETA: 2s - loss: 0.0055 - accuracy: 0.94592900/4989 [================>.............] - ETA: 2s - loss: 0.0055 - accuracy: 0.94632944/4989 [================>.............] - ETA: 2s - loss: 0.0055 - accuracy: 0.94592987/4989 [================>.............] - ETA: 2s - loss: 0.0055 - accuracy: 0.94603037/4989 [=================>............] - ETA: 2s - loss: 0.0055 - accuracy: 0.94633088/4989 [=================>............] - ETA: 2s - loss: 0.0054 - accuracy: 0.94673138/4989 [=================>............] - ETA: 2s - loss: 0.0054 - accuracy: 0.94683187/4989 [==================>...........] - ETA: 1s - loss: 0.0054 - accuracy: 0.94693234/4989 [==================>...........] - ETA: 1s - loss: 0.0054 - accuracy: 0.94693280/4989 [==================>...........] - ETA: 1s - loss: 0.0055 - accuracy: 0.94653332/4989 [===================>..........] - ETA: 1s - loss: 0.0055 - accuracy: 0.94683386/4989 [===================>..........] - ETA: 1s - loss: 0.0055 - accuracy: 0.94713437/4989 [===================>..........] - ETA: 1s - loss: 0.0055 - accuracy: 0.94713476/4989 [===================>..........] - ETA: 1s - loss: 0.0055 - accuracy: 0.94683519/4989 [====================>.........] - ETA: 1s - loss: 0.0055 - accuracy: 0.94673558/4989 [====================>.........] - ETA: 1s - loss: 0.0055 - accuracy: 0.94673604/4989 [====================>.........] - ETA: 1s - loss: 0.0054 - accuracy: 0.94693654/4989 [====================>.........] - ETA: 1s - loss: 0.0054 - accuracy: 0.94723709/4989 [=====================>........] - ETA: 1s - loss: 0.0054 - accuracy: 0.94753762/4989 [=====================>........] - ETA: 1s - loss: 0.0054 - accuracy: 0.94743817/4989 [=====================>........] - ETA: 1s - loss: 0.0054 - accuracy: 0.94763871/4989 [======================>.......] - ETA: 1s - loss: 0.0054 - accuracy: 0.94783924/4989 [======================>.......] - ETA: 1s - loss: 0.0053 - accuracy: 0.94803976/4989 [======================>.......] - ETA: 1s - loss: 0.0054 - accuracy: 0.94804030/4989 [=======================>......] - ETA: 1s - loss: 0.0054 - accuracy: 0.94814084/4989 [=======================>......] - ETA: 0s - loss: 0.0053 - accuracy: 0.94824138/4989 [=======================>......] - ETA: 0s - loss: 0.0054 - accuracy: 0.94814193/4989 [========================>.....] - ETA: 0s - loss: 0.0054 - accuracy: 0.94774247/4989 [========================>.....] - ETA: 0s - loss: 0.0054 - accuracy: 0.94754295/4989 [========================>.....] - ETA: 0s - loss: 0.0054 - accuracy: 0.94734343/4989 [=========================>....] - ETA: 0s - loss: 0.0054 - accuracy: 0.94764393/4989 [=========================>....] - ETA: 0s - loss: 0.0054 - accuracy: 0.94784444/4989 [=========================>....] - ETA: 0s - loss: 0.0054 - accuracy: 0.94784488/4989 [=========================>....] - ETA: 0s - loss: 0.0054 - accuracy: 0.94784532/4989 [==========================>...] - ETA: 0s - loss: 0.0054 - accuracy: 0.94794578/4989 [==========================>...] - ETA: 0s - loss: 0.0054 - accuracy: 0.94764628/4989 [==========================>...] - ETA: 0s - loss: 0.0054 - accuracy: 0.94774678/4989 [===========================>..] - ETA: 0s - loss: 0.0054 - accuracy: 0.94794719/4989 [===========================>..] - ETA: 0s - loss: 0.0054 - accuracy: 0.94804762/4989 [===========================>..] - ETA: 0s - loss: 0.0054 - accuracy: 0.94814806/4989 [===========================>..] - ETA: 0s - loss: 0.0054 - accuracy: 0.94824852/4989 [============================>.] - ETA: 0s - loss: 0.0053 - accuracy: 0.94834904/4989 [============================>.] - ETA: 0s - loss: 0.0053 - accuracy: 0.94844956/4989 [============================>.] - ETA: 0s - loss: 0.0054 - accuracy: 0.9483
Epoch 5: val_loss did not improve from 0.00573
4989/4989 [==============================] - 6s 1ms/step - loss: 0.0054 - accuracy: 0.9481 - val_loss: 0.0058 - val_accuracy: 0.9447
                         : Getting training history for item:0 name = 'loss'
                         : Getting training history for item:1 name = 'accuracy'
                         : Getting training history for item:2 name = 'val_loss'
                         : Getting training history for item:3 name = 'val_accuracy'
                         : Elapsed time for training with 399092 events: [1;31m98.7 sec[0m         
                         : Setting up tf.keras
                         : Using TensorFlow version 2
                         : Use Keras version from TensorFlow : tf.keras
                         : Disabled TF eager execution when evaluating model 
                         :  Loading Keras Model 
                         : Loaded model from file: TMVA_keras_models/keras_shallow_model_old_TMVA_trained_model.h5
PyKeras                  : [dataset] : Evaluation of PyKeras on training sample (399092 events)
                         : Elapsed time for evaluation of 399092 events: [1;31m3.24 sec[0m       
                         : Creating xml weight file: [0;36mdataset/weights/TMVAClassification_PyKeras.weights.xml[0m
                         : Creating standalone class: [0;36mdataset/weights/TMVAClassification_PyKeras.class.C[0m
Factory                  : Training finished
                         : 
                         : Ranking input variables (method specific)...
                         : No variable ranking supplied by classifier: PyKeras
TH1.Print Name  = TrainingHistory_PyKeras_'accuracy', Entries= 0, Total sum= 4.73238
TH1.Print Name  = TrainingHistory_PyKeras_'loss', Entries= 0, Total sum= 0.0280632
TH1.Print Name  = TrainingHistory_PyKeras_'val_accuracy', Entries= 0, Total sum= 4.72907
TH1.Print Name  = TrainingHistory_PyKeras_'val_loss', Entries= 0, Total sum= 0.0288407
Factory                  : === Destroy and recreate all methods via weight files for testing ===
                         : 
                         : Reading weight file: [0;36mdataset/weights/TMVAClassification_PyKeras.weights.xml[0m
Factory                  : [1mTest all methods[0m
Factory                  : Test method: PyKeras for Classification performance
                         : 
                         : Setting up tf.keras
                         : Using TensorFlow version 2
                         : Use Keras version from TensorFlow : tf.keras
                         : Disabled TF eager execution when evaluating model 
                         :  Loading Keras Model 
                         : Loaded model from file: TMVA_keras_models/keras_shallow_model_old_TMVA_trained_model.h5
PyKeras                  : [dataset] : Evaluation of PyKeras on testing sample (99772 events)
                         : Elapsed time for evaluation of 99772 events: [1;31m0.889 sec[0m       
Factory                  : [1mEvaluate all methods[0m
Factory                  : Evaluate classifier: PyKeras
                         : 
TFHandler_PyKeras        :              Variable                     Mean                     RMS             [        Min                     Max ]
                         : ----------------------------------------------------------------------------------------------------------------------------
                         : C_Hnl_vertex_2DSig_BS:                0.21920                0.96232   [                -3.3619                 5.7307 ]
                         :    C_Hnl_vertex_cos2D:              0.0043939                0.92004   [                -3.4027                 5.7307 ]
                         :         C_pi_BS_ip_xy:                0.11167                 1.0133   [                -3.1827                 5.7307 ]
                         :  C_Ds_vertex_2DSig_BS:              -0.022814                0.98951   [                -3.2454                 5.7307 ]
                         : ----------------------------------------------------------------------------------------------------------------------------
PyKeras                  : [dataset] : Loop over test events and fill histograms with classifier response...
                         : 
TFHandler_PyKeras        :              Variable                     Mean                     RMS             [        Min                     Max ]
                         : ----------------------------------------------------------------------------------------------------------------------------
                         : C_Hnl_vertex_2DSig_BS:                0.21920                0.96232   [                -3.3619                 5.7307 ]
                         :    C_Hnl_vertex_cos2D:              0.0043939                0.92004   [                -3.4027                 5.7307 ]
                         :         C_pi_BS_ip_xy:                0.11167                 1.0133   [                -3.1827                 5.7307 ]
                         :  C_Ds_vertex_2DSig_BS:              -0.022814                0.98951   [                -3.2454                 5.7307 ]
                         : ----------------------------------------------------------------------------------------------------------------------------
                         : 
                         : Evaluation results ranked by best signal efficiency and purity (area)
                         : -------------------------------------------------------------------------------------------------------------------
                         : DataSet       MVA                       
                         : Name:         Method:          ROC-integ
                         : dataset       PyKeras        : 0.989
                         : -------------------------------------------------------------------------------------------------------------------
                         : 
                         : Testing efficiency compared to training efficiency (overtraining check)
                         : -------------------------------------------------------------------------------------------------------------------
                         : DataSet              MVA              Signal efficiency: from test sample (from training sample) 
                         : Name:                Method:          @B=0.01             @B=0.10            @B=0.30   
                         : -------------------------------------------------------------------------------------------------------------------
                         : dataset              PyKeras        : 0.847 (0.846)       0.976 (0.976)      0.995 (0.995)
                         : -------------------------------------------------------------------------------------------------------------------
                         : 
Dataset:dataset          : Created tree 'TestTree' with 99772 events
                         : 
Dataset:dataset          : Created tree 'TrainTree' with 399092 events
                         : 
Factory                  : [1mThank you for using TMVA![0m
                         : [1mFor citation information, please visit: http://tmva.sf.net/citeTMVA.html[0m
