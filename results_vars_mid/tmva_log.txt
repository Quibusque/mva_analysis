DataSetInfo              : [dataset] : Added class "Signal"
                         : Add Tree final_tree of type Signal with 9783 events
DataSetInfo              : [dataset] : Added class "Background"
                         : Add Tree final_tree of type Background with 489081 events
                         : Dataset[dataset] : Class index : 0  name : Signal
                         : Dataset[dataset] : Class index : 1  name : Background
Factory                  : Booking method: [1mPyKeras[0m
                         : 
                         : Setting up tf.keras
                         : Using TensorFlow version 2
                         : Use Keras version from TensorFlow : tf.keras
                         :  Loading Keras Model 
                         : Loaded model from file: TMVA_keras_models/keras_shallow_model_old_TMVA.h5
Factory                  : [1mTrain all methods[0m
                         : Rebuilding Dataset dataset
                         : Building event vectors for type 2 Signal
                         : Dataset[dataset] :  create input formulas for tree final_tree
                         : Building event vectors for type 2 Background
                         : Dataset[dataset] :  create input formulas for tree final_tree
                         : Dataset[dataset] :  create input formulas for tree final_tree
                         : Dataset[dataset] :  create input formulas for tree final_tree
                         : Dataset[dataset] :  create input formulas for tree final_tree
                         : Dataset[dataset] :  create input formulas for tree final_tree
                         : Dataset[dataset] :  create input formulas for tree final_tree
                         : Dataset[dataset] :  create input formulas for tree final_tree
DataSetFactory           : [dataset] : Number of events in input trees
                         : 
                         : 
                         : Dataset[dataset] : Weight renormalisation mode: "EqualNumEvents": renormalises all event classes ...
                         : Dataset[dataset] :  such that the effective (weighted) number of events in each class is the same 
                         : Dataset[dataset] :  (and equals the number of events (entries) given for class=0 )
                         : Dataset[dataset] : ... i.e. such that Sum[i=1..N_j]{w_i} = N_classA, j=classA, classB, ...
                         : Dataset[dataset] : ... (note that N_j is the sum of TRAINING events
                         : Dataset[dataset] :  ..... Testing events are not renormalised nor included in the renormalisation factor!)
                         : Number of training and testing events
                         : ---------------------------------------------------------------------------
                         : Signal     -- training events            : 7827
                         : Signal     -- testing events             : 1956
                         : Signal     -- training and testing events: 9783
                         : Background -- training events            : 391265
                         : Background -- testing events             : 97816
                         : Background -- training and testing events: 489081
                         : 
DataSetInfo              : Correlation matrix (Signal):
                         : ---------------------------------------------------------------------------------------------------
                         :                           C_mu_Ds_BS_ips_xy C_mu1mu2_dr C_mu_Hnl_BS_ips_xy C_mu_Hnl_nValidPixelHits
                         :        C_mu_Ds_BS_ips_xy:            +1.000      -0.034             +0.047                   -0.018
                         :              C_mu1mu2_dr:            -0.034      +1.000             +0.009                   +0.045
                         :       C_mu_Hnl_BS_ips_xy:            +0.047      +0.009             +1.000                   -0.087
                         : C_mu_Hnl_nValidPixelHits:            -0.018      +0.045             -0.087                   +1.000
                         : ---------------------------------------------------------------------------------------------------
DataSetInfo              : Correlation matrix (Background):
                         : ---------------------------------------------------------------------------------------------------
                         :                           C_mu_Ds_BS_ips_xy C_mu1mu2_dr C_mu_Hnl_BS_ips_xy C_mu_Hnl_nValidPixelHits
                         :        C_mu_Ds_BS_ips_xy:            +1.000      +0.086             +0.331                   +0.010
                         :              C_mu1mu2_dr:            +0.086      +1.000             +0.095                   +0.025
                         :       C_mu_Hnl_BS_ips_xy:            +0.331      +0.095             +1.000                   +0.031
                         : C_mu_Hnl_nValidPixelHits:            +0.010      +0.025             +0.031                   +1.000
                         : ---------------------------------------------------------------------------------------------------
DataSetFactory           : [dataset] :  
                         : 
Factory                  : [dataset] : Create Transformation "I" with events from all classes.
                         : 
                         : Transformation, Variable selection : 
                         : Input : variable 'C_mu_Ds_BS_ips_xy' <---> Output : variable 'C_mu_Ds_BS_ips_xy'
                         : Input : variable 'C_mu1mu2_dr' <---> Output : variable 'C_mu1mu2_dr'
                         : Input : variable 'C_mu_Hnl_BS_ips_xy' <---> Output : variable 'C_mu_Hnl_BS_ips_xy'
                         : Input : variable 'C_mu_Hnl_nValidPixelHits' <---> Output : variable 'C_mu_Hnl_nValidPixelHits'
TFHandler_Factory        :                 Variable                        Mean                        RMS                [        Min                        Max ]
                         : -------------------------------------------------------------------------------------------------------------------------------------------
                         :        C_mu_Ds_BS_ips_xy:                    9.2698                    12.085   [                2.9539e-05                    316.81 ]
                         :              C_mu1mu2_dr:                   0.16504                  0.074485   [                0.00047892                   0.56149 ]
                         :       C_mu_Hnl_BS_ips_xy:                    23.443                    25.538   [                1.4458e-05                    316.81 ]
                         : C_mu_Hnl_nValidPixelHits:                    3.3399                   0.94868   [                    0.0000                    9.0000 ]
                         : -------------------------------------------------------------------------------------------------------------------------------------------
                         : Ranking input variables (method unspecific)...
IdTransformation         : Ranking result (top variable is best ranked)
                         : -------------------------------------------------
                         : Rank : Variable                 : Separation
                         : -------------------------------------------------
                         :    1 : C_mu_Hnl_BS_ips_xy       : 3.817e-01
                         :    2 : C_mu_Hnl_nValidPixelHits : 1.144e-01
                         :    3 : C_mu1mu2_dr              : 3.858e-02
                         :    4 : C_mu_Ds_BS_ips_xy        : 1.389e-02
                         : -------------------------------------------------
Factory                  : Train method: PyKeras for Classification
                         : 
                         : 
                         : [1m================================================================[0m
                         : [1mH e l p   f o r   M V A   m e t h o d   [ PyKeras ] :[0m
                         : 
                         : Keras is a high-level API for the Theano and Tensorflow packages.
                         : This method wraps the training and predictions steps of the Keras
                         : Python package for TMVA, so that dataloading, preprocessing and
                         : evaluation can be done within the TMVA system. To use this Keras
                         : interface, you have to generate a model with Keras first. Then,
                         : this model can be loaded and trained in TMVA.
                         : 
                         : 
                         : <Suppress this message by specifying "!H" in the booking option>
                         : [1m================================================================[0m
                         : 
                         : Split TMVA training data in 319274 training events and 79818 validation events
                         : Training Model Summary
running TMVA for signal mN1p0_ctau10
keras_par_string: H:!V:FilenameModel=TMVA_keras_models/keras_shallow_model_old_TMVA.h5:FilenameTrainedModel=TMVA_keras_models/keras_shallow_model_old_TMVA_trained_model.h5:NumEpochs=5:BatchSize=64:Verbose=1
dealing with signal mN1p0_ctau10
signal file name: /home/quibus/hnl_ntuples_for_mva/tree_HnlToMuPi_prompt_DsToNMu_NToMuPi_SoftQCDnonD_noQuarkFilter_mN1p0_ctau10p0mm_TuneCP5_13TeV-pythia8-evtgen_tree_new.root
factory_string: !V:!Silent:Color:DrawProgressBar:AnalysisType=Classification
Model: "sequential_1"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 normalization_1 (Normalizat  (None, 4)                9         
 ion)                                                            
                                                                 
 dense_2 (Dense)             (None, 64)                320       
                                                                 
 dense_3 (Dense)             (None, 2)                 130       
                                                                 
=================================================================
Total params: 459
Trainable params: 450
Non-trainable params: 9
_________________________________________________________________
                         : Option SaveBestOnly: Only model weights with smallest validation loss will be stored
Epoch 1/5
   1/4989 [..............................] - ETA: 42:17 - loss: 0.1663 - accuracy: 0.6556  42/4989 [..............................] - ETA: 6s - loss: 0.0531 - accuracy: 0.5868     84/4989 [..............................] - ETA: 6s - loss: 0.0369 - accuracy: 0.6908 132/4989 [..............................] - ETA: 5s - loss: 0.0300 - accuracy: 0.7270 178/4989 [>.............................] - ETA: 5s - loss: 0.0265 - accuracy: 0.7446 224/4989 [>.............................] - ETA: 5s - loss: 0.0248 - accuracy: 0.7547 273/4989 [>.............................] - ETA: 5s - loss: 0.0234 - accuracy: 0.7740 316/4989 [>.............................] - ETA: 5s - loss: 0.0233 - accuracy: 0.7663 354/4989 [=>............................] - ETA: 5s - loss: 0.0231 - accuracy: 0.7670 397/4989 [=>............................] - ETA: 5s - loss: 0.0223 - accuracy: 0.7747 442/4989 [=>............................] - ETA: 5s - loss: 0.0220 - accuracy: 0.7801 488/4989 [=>............................] - ETA: 5s - loss: 0.0215 - accuracy: 0.7821 532/4989 [==>...........................] - ETA: 5s - loss: 0.0211 - accuracy: 0.7843 580/4989 [==>...........................] - ETA: 5s - loss: 0.0209 - accuracy: 0.7809 632/4989 [==>...........................] - ETA: 4s - loss: 0.0209 - accuracy: 0.7811 683/4989 [===>..........................] - ETA: 4s - loss: 0.0205 - accuracy: 0.7852 736/4989 [===>..........................] - ETA: 4s - loss: 0.0203 - accuracy: 0.7871 787/4989 [===>..........................] - ETA: 4s - loss: 0.0203 - accuracy: 0.7869 840/4989 [====>.........................] - ETA: 4s - loss: 0.0200 - accuracy: 0.7887 892/4989 [====>.........................] - ETA: 4s - loss: 0.0197 - accuracy: 0.7915 945/4989 [====>.........................] - ETA: 4s - loss: 0.0195 - accuracy: 0.7908 994/4989 [====>.........................] - ETA: 4s - loss: 0.0194 - accuracy: 0.79251046/4989 [=====>........................] - ETA: 4s - loss: 0.0195 - accuracy: 0.79141097/4989 [=====>........................] - ETA: 4s - loss: 0.0192 - accuracy: 0.79381150/4989 [=====>........................] - ETA: 4s - loss: 0.0192 - accuracy: 0.79421199/4989 [======>.......................] - ETA: 3s - loss: 0.0192 - accuracy: 0.79471251/4989 [======>.......................] - ETA: 3s - loss: 0.0193 - accuracy: 0.79321301/4989 [======>.......................] - ETA: 3s - loss: 0.0193 - accuracy: 0.79241345/4989 [=======>......................] - ETA: 3s - loss: 0.0192 - accuracy: 0.79291389/4989 [=======>......................] - ETA: 3s - loss: 0.0191 - accuracy: 0.79341434/4989 [=======>......................] - ETA: 3s - loss: 0.0191 - accuracy: 0.79241479/4989 [=======>......................] - ETA: 3s - loss: 0.0191 - accuracy: 0.79211512/4989 [========>.....................] - ETA: 3s - loss: 0.0191 - accuracy: 0.79211546/4989 [========>.....................] - ETA: 3s - loss: 0.0191 - accuracy: 0.79081589/4989 [========>.....................] - ETA: 3s - loss: 0.0191 - accuracy: 0.78921630/4989 [========>.....................] - ETA: 3s - loss: 0.0191 - accuracy: 0.79001679/4989 [=========>....................] - ETA: 3s - loss: 0.0190 - accuracy: 0.79041727/4989 [=========>....................] - ETA: 3s - loss: 0.0189 - accuracy: 0.79091777/4989 [=========>....................] - ETA: 3s - loss: 0.0189 - accuracy: 0.79081830/4989 [==========>...................] - ETA: 3s - loss: 0.0189 - accuracy: 0.79041882/4989 [==========>...................] - ETA: 3s - loss: 0.0190 - accuracy: 0.79051934/4989 [==========>...................] - ETA: 3s - loss: 0.0190 - accuracy: 0.79051984/4989 [==========>...................] - ETA: 3s - loss: 0.0189 - accuracy: 0.79142036/4989 [===========>..................] - ETA: 3s - loss: 0.0188 - accuracy: 0.79162086/4989 [===========>..................] - ETA: 3s - loss: 0.0188 - accuracy: 0.79182132/4989 [===========>..................] - ETA: 3s - loss: 0.0187 - accuracy: 0.79272183/4989 [============>.................] - ETA: 2s - loss: 0.0186 - accuracy: 0.79222231/4989 [============>.................] - ETA: 2s - loss: 0.0187 - accuracy: 0.79232283/4989 [============>.................] - ETA: 2s - loss: 0.0187 - accuracy: 0.79312334/4989 [=============>................] - ETA: 2s - loss: 0.0186 - accuracy: 0.79292385/4989 [=============>................] - ETA: 2s - loss: 0.0186 - accuracy: 0.79322436/4989 [=============>................] - ETA: 2s - loss: 0.0186 - accuracy: 0.79332478/4989 [=============>................] - ETA: 2s - loss: 0.0186 - accuracy: 0.79332524/4989 [==============>...............] - ETA: 2s - loss: 0.0186 - accuracy: 0.79362577/4989 [==============>...............] - ETA: 2s - loss: 0.0185 - accuracy: 0.79422629/4989 [==============>...............] - ETA: 2s - loss: 0.0185 - accuracy: 0.79492682/4989 [===============>..............] - ETA: 2s - loss: 0.0185 - accuracy: 0.79502733/4989 [===============>..............] - ETA: 2s - loss: 0.0184 - accuracy: 0.79592785/4989 [===============>..............] - ETA: 2s - loss: 0.0183 - accuracy: 0.79642835/4989 [================>.............] - ETA: 2s - loss: 0.0183 - accuracy: 0.79692888/4989 [================>.............] - ETA: 2s - loss: 0.0183 - accuracy: 0.79712938/4989 [================>.............] - ETA: 2s - loss: 0.0182 - accuracy: 0.79752990/4989 [================>.............] - ETA: 2s - loss: 0.0183 - accuracy: 0.79683042/4989 [=================>............] - ETA: 2s - loss: 0.0183 - accuracy: 0.79693093/4989 [=================>............] - ETA: 1s - loss: 0.0183 - accuracy: 0.79643145/4989 [=================>............] - ETA: 1s - loss: 0.0183 - accuracy: 0.79663196/4989 [==================>...........] - ETA: 1s - loss: 0.0183 - accuracy: 0.79683245/4989 [==================>...........] - ETA: 1s - loss: 0.0183 - accuracy: 0.79673296/4989 [==================>...........] - ETA: 1s - loss: 0.0183 - accuracy: 0.79683346/4989 [===================>..........] - ETA: 1s - loss: 0.0183 - accuracy: 0.79653397/4989 [===================>..........] - ETA: 1s - loss: 0.0182 - accuracy: 0.79703451/4989 [===================>..........] - ETA: 1s - loss: 0.0182 - accuracy: 0.79763492/4989 [===================>..........] - ETA: 1s - loss: 0.0182 - accuracy: 0.79813541/4989 [====================>.........] - ETA: 1s - loss: 0.0181 - accuracy: 0.79833594/4989 [====================>.........] - ETA: 1s - loss: 0.0181 - accuracy: 0.79863645/4989 [====================>.........] - ETA: 1s - loss: 0.0181 - accuracy: 0.79873697/4989 [=====================>........] - ETA: 1s - loss: 0.0181 - accuracy: 0.79903748/4989 [=====================>........] - ETA: 1s - loss: 0.0181 - accuracy: 0.79953799/4989 [=====================>........] - ETA: 1s - loss: 0.0180 - accuracy: 0.79963851/4989 [======================>.......] - ETA: 1s - loss: 0.0180 - accuracy: 0.79973903/4989 [======================>.......] - ETA: 1s - loss: 0.0180 - accuracy: 0.80023951/4989 [======================>.......] - ETA: 1s - loss: 0.0180 - accuracy: 0.80024002/4989 [=======================>......] - ETA: 1s - loss: 0.0180 - accuracy: 0.79974048/4989 [=======================>......] - ETA: 0s - loss: 0.0180 - accuracy: 0.79974097/4989 [=======================>......] - ETA: 0s - loss: 0.0180 - accuracy: 0.80024148/4989 [=======================>......] - ETA: 0s - loss: 0.0180 - accuracy: 0.80054201/4989 [========================>.....] - ETA: 0s - loss: 0.0180 - accuracy: 0.80034252/4989 [========================>.....] - ETA: 0s - loss: 0.0180 - accuracy: 0.79994304/4989 [========================>.....] - ETA: 0s - loss: 0.0179 - accuracy: 0.80054354/4989 [=========================>....] - ETA: 0s - loss: 0.0179 - accuracy: 0.80074405/4989 [=========================>....] - ETA: 0s - loss: 0.0179 - accuracy: 0.80094457/4989 [=========================>....] - ETA: 0s - loss: 0.0179 - accuracy: 0.80074494/4989 [==========================>...] - ETA: 0s - loss: 0.0179 - accuracy: 0.80124546/4989 [==========================>...] - ETA: 0s - loss: 0.0179 - accuracy: 0.80114598/4989 [==========================>...] - ETA: 0s - loss: 0.0179 - accuracy: 0.80154650/4989 [==========================>...] - ETA: 0s - loss: 0.0179 - accuracy: 0.80104702/4989 [===========================>..] - ETA: 0s - loss: 0.0179 - accuracy: 0.80134753/4989 [===========================>..] - ETA: 0s - loss: 0.0179 - accuracy: 0.80144805/4989 [===========================>..] - ETA: 0s - loss: 0.0179 - accuracy: 0.80204856/4989 [============================>.] - ETA: 0s - loss: 0.0179 - accuracy: 0.80174906/4989 [============================>.] - ETA: 0s - loss: 0.0179 - accuracy: 0.80204956/4989 [============================>.] - ETA: 0s - loss: 0.0178 - accuracy: 0.8022
Epoch 1: val_loss improved from inf to 0.01795, saving model to TMVA_keras_models/keras_shallow_model_old_TMVA_trained_model.h5
4989/4989 [==============================] - 22s 4ms/step - loss: 0.0179 - accuracy: 0.8021 - val_loss: 0.0180 - val_accuracy: 0.7968
Epoch 2/5
   1/4989 [..............................] - ETA: 6s - loss: 0.0072 - accuracy: 0.7143  35/4989 [..............................] - ETA: 7s - loss: 0.0148 - accuracy: 0.8287  87/4989 [..............................] - ETA: 5s - loss: 0.0173 - accuracy: 0.8037 142/4989 [..............................] - ETA: 5s - loss: 0.0171 - accuracy: 0.7998 193/4989 [>.............................] - ETA: 5s - loss: 0.0169 - accuracy: 0.8092 245/4989 [>.............................] - ETA: 4s - loss: 0.0178 - accuracy: 0.7970 295/4989 [>.............................] - ETA: 4s - loss: 0.0169 - accuracy: 0.8070 346/4989 [=>............................] - ETA: 4s - loss: 0.0166 - accuracy: 0.8141 395/4989 [=>............................] - ETA: 4s - loss: 0.0171 - accuracy: 0.8097 448/4989 [=>............................] - ETA: 4s - loss: 0.0175 - accuracy: 0.8098 501/4989 [==>...........................] - ETA: 4s - loss: 0.0171 - accuracy: 0.8167 555/4989 [==>...........................] - ETA: 4s - loss: 0.0175 - accuracy: 0.8114 606/4989 [==>...........................] - ETA: 4s - loss: 0.0173 - accuracy: 0.8124 657/4989 [==>...........................] - ETA: 4s - loss: 0.0173 - accuracy: 0.8127 707/4989 [===>..........................] - ETA: 4s - loss: 0.0174 - accuracy: 0.8096 758/4989 [===>..........................] - ETA: 4s - loss: 0.0174 - accuracy: 0.8098 807/4989 [===>..........................] - ETA: 4s - loss: 0.0175 - accuracy: 0.8090 853/4989 [====>.........................] - ETA: 4s - loss: 0.0175 - accuracy: 0.8079 893/4989 [====>.........................] - ETA: 4s - loss: 0.0176 - accuracy: 0.8068 935/4989 [====>.........................] - ETA: 4s - loss: 0.0175 - accuracy: 0.8063 974/4989 [====>.........................] - ETA: 4s - loss: 0.0174 - accuracy: 0.80691013/4989 [=====>........................] - ETA: 4s - loss: 0.0174 - accuracy: 0.80751050/4989 [=====>........................] - ETA: 4s - loss: 0.0175 - accuracy: 0.80601090/4989 [=====>........................] - ETA: 4s - loss: 0.0174 - accuracy: 0.80641131/4989 [=====>........................] - ETA: 4s - loss: 0.0173 - accuracy: 0.80771172/4989 [======>.......................] - ETA: 4s - loss: 0.0173 - accuracy: 0.80741217/4989 [======>.......................] - ETA: 4s - loss: 0.0172 - accuracy: 0.80761266/4989 [======>.......................] - ETA: 4s - loss: 0.0173 - accuracy: 0.80661316/4989 [======>.......................] - ETA: 3s - loss: 0.0173 - accuracy: 0.80601369/4989 [=======>......................] - ETA: 3s - loss: 0.0172 - accuracy: 0.80591418/4989 [=======>......................] - ETA: 3s - loss: 0.0173 - accuracy: 0.80561469/4989 [=======>......................] - ETA: 3s - loss: 0.0173 - accuracy: 0.80621519/4989 [========>.....................] - ETA: 3s - loss: 0.0173 - accuracy: 0.80581570/4989 [========>.....................] - ETA: 3s - loss: 0.0172 - accuracy: 0.80751619/4989 [========>.....................] - ETA: 3s - loss: 0.0171 - accuracy: 0.80771672/4989 [=========>....................] - ETA: 3s - loss: 0.0172 - accuracy: 0.80671722/4989 [=========>....................] - ETA: 3s - loss: 0.0173 - accuracy: 0.80661772/4989 [=========>....................] - ETA: 3s - loss: 0.0173 - accuracy: 0.80671821/4989 [=========>....................] - ETA: 3s - loss: 0.0172 - accuracy: 0.80681874/4989 [==========>...................] - ETA: 3s - loss: 0.0172 - accuracy: 0.80671916/4989 [==========>...................] - ETA: 3s - loss: 0.0172 - accuracy: 0.80681968/4989 [==========>...................] - ETA: 3s - loss: 0.0172 - accuracy: 0.80662021/4989 [===========>..................] - ETA: 3s - loss: 0.0172 - accuracy: 0.80652071/4989 [===========>..................] - ETA: 3s - loss: 0.0172 - accuracy: 0.80572121/4989 [===========>..................] - ETA: 3s - loss: 0.0172 - accuracy: 0.80492174/4989 [============>.................] - ETA: 2s - loss: 0.0172 - accuracy: 0.80552225/4989 [============>.................] - ETA: 2s - loss: 0.0172 - accuracy: 0.80552277/4989 [============>.................] - ETA: 2s - loss: 0.0173 - accuracy: 0.80442328/4989 [============>.................] - ETA: 2s - loss: 0.0173 - accuracy: 0.80422380/4989 [=============>................] - ETA: 2s - loss: 0.0173 - accuracy: 0.80432431/4989 [=============>................] - ETA: 2s - loss: 0.0174 - accuracy: 0.80412482/4989 [=============>................] - ETA: 2s - loss: 0.0174 - accuracy: 0.80362534/4989 [==============>...............] - ETA: 2s - loss: 0.0173 - accuracy: 0.80432586/4989 [==============>...............] - ETA: 2s - loss: 0.0174 - accuracy: 0.80412638/4989 [==============>...............] - ETA: 2s - loss: 0.0173 - accuracy: 0.80412689/4989 [===============>..............] - ETA: 2s - loss: 0.0173 - accuracy: 0.80412737/4989 [===============>..............] - ETA: 2s - loss: 0.0174 - accuracy: 0.80372789/4989 [===============>..............] - ETA: 2s - loss: 0.0174 - accuracy: 0.80382841/4989 [================>.............] - ETA: 2s - loss: 0.0174 - accuracy: 0.80392894/4989 [================>.............] - ETA: 2s - loss: 0.0173 - accuracy: 0.80442934/4989 [================>.............] - ETA: 2s - loss: 0.0172 - accuracy: 0.80522984/4989 [================>.............] - ETA: 2s - loss: 0.0173 - accuracy: 0.80523035/4989 [=================>............] - ETA: 2s - loss: 0.0173 - accuracy: 0.80473084/4989 [=================>............] - ETA: 1s - loss: 0.0173 - accuracy: 0.80503133/4989 [=================>............] - ETA: 1s - loss: 0.0173 - accuracy: 0.80473183/4989 [==================>...........] - ETA: 1s - loss: 0.0173 - accuracy: 0.80493233/4989 [==================>...........] - ETA: 1s - loss: 0.0173 - accuracy: 0.80473286/4989 [==================>...........] - ETA: 1s - loss: 0.0173 - accuracy: 0.80573339/4989 [===================>..........] - ETA: 1s - loss: 0.0173 - accuracy: 0.80523392/4989 [===================>..........] - ETA: 1s - loss: 0.0172 - accuracy: 0.80553443/4989 [===================>..........] - ETA: 1s - loss: 0.0172 - accuracy: 0.80593494/4989 [====================>.........] - ETA: 1s - loss: 0.0172 - accuracy: 0.80603544/4989 [====================>.........] - ETA: 1s - loss: 0.0172 - accuracy: 0.80533597/4989 [====================>.........] - ETA: 1s - loss: 0.0173 - accuracy: 0.80503646/4989 [====================>.........] - ETA: 1s - loss: 0.0173 - accuracy: 0.80513698/4989 [=====================>........] - ETA: 1s - loss: 0.0172 - accuracy: 0.80543746/4989 [=====================>........] - ETA: 1s - loss: 0.0173 - accuracy: 0.80533797/4989 [=====================>........] - ETA: 1s - loss: 0.0172 - accuracy: 0.80523848/4989 [======================>.......] - ETA: 1s - loss: 0.0172 - accuracy: 0.80583901/4989 [======================>.......] - ETA: 1s - loss: 0.0172 - accuracy: 0.80563945/4989 [======================>.......] - ETA: 1s - loss: 0.0172 - accuracy: 0.80563997/4989 [=======================>......] - ETA: 1s - loss: 0.0172 - accuracy: 0.80554049/4989 [=======================>......] - ETA: 0s - loss: 0.0172 - accuracy: 0.80554101/4989 [=======================>......] - ETA: 0s - loss: 0.0171 - accuracy: 0.80604148/4989 [=======================>......] - ETA: 0s - loss: 0.0171 - accuracy: 0.80584196/4989 [========================>.....] - ETA: 0s - loss: 0.0171 - accuracy: 0.80584244/4989 [========================>.....] - ETA: 0s - loss: 0.0171 - accuracy: 0.80624292/4989 [========================>.....] - ETA: 0s - loss: 0.0171 - accuracy: 0.80644340/4989 [=========================>....] - ETA: 0s - loss: 0.0171 - accuracy: 0.80654393/4989 [=========================>....] - ETA: 0s - loss: 0.0171 - accuracy: 0.80654441/4989 [=========================>....] - ETA: 0s - loss: 0.0171 - accuracy: 0.80634493/4989 [==========================>...] - ETA: 0s - loss: 0.0171 - accuracy: 0.80664545/4989 [==========================>...] - ETA: 0s - loss: 0.0171 - accuracy: 0.80684597/4989 [==========================>...] - ETA: 0s - loss: 0.0171 - accuracy: 0.80694649/4989 [==========================>...] - ETA: 0s - loss: 0.0171 - accuracy: 0.80674700/4989 [===========================>..] - ETA: 0s - loss: 0.0171 - accuracy: 0.80714751/4989 [===========================>..] - ETA: 0s - loss: 0.0171 - accuracy: 0.80684805/4989 [===========================>..] - ETA: 0s - loss: 0.0171 - accuracy: 0.80644855/4989 [============================>.] - ETA: 0s - loss: 0.0171 - accuracy: 0.80574903/4989 [============================>.] - ETA: 0s - loss: 0.0172 - accuracy: 0.80574948/4989 [============================>.] - ETA: 0s - loss: 0.0171 - accuracy: 0.8058
Epoch 2: val_loss improved from 0.01795 to 0.01726, saving model to TMVA_keras_models/keras_shallow_model_old_TMVA_trained_model.h5
4989/4989 [==============================] - 6s 1ms/step - loss: 0.0171 - accuracy: 0.8060 - val_loss: 0.0173 - val_accuracy: 0.8054
Epoch 3/5
   1/4989 [..............................] - ETA: 6s - loss: 0.0055 - accuracy: 0.7976  41/4989 [..............................] - ETA: 6s - loss: 0.0148 - accuracy: 0.8446  91/4989 [..............................] - ETA: 5s - loss: 0.0169 - accuracy: 0.8030 142/4989 [..............................] - ETA: 5s - loss: 0.0172 - accuracy: 0.7993 193/4989 [>.............................] - ETA: 5s - loss: 0.0169 - accuracy: 0.8063 247/4989 [>.............................] - ETA: 4s - loss: 0.0167 - accuracy: 0.8154 298/4989 [>.............................] - ETA: 4s - loss: 0.0166 - accuracy: 0.8188 350/4989 [=>............................] - ETA: 4s - loss: 0.0162 - accuracy: 0.8210 402/4989 [=>............................] - ETA: 4s - loss: 0.0168 - accuracy: 0.8090 455/4989 [=>............................] - ETA: 4s - loss: 0.0169 - accuracy: 0.8023 506/4989 [==>...........................] - ETA: 4s - loss: 0.0169 - accuracy: 0.8058 559/4989 [==>...........................] - ETA: 4s - loss: 0.0167 - accuracy: 0.8087 609/4989 [==>...........................] - ETA: 4s - loss: 0.0165 - accuracy: 0.8127 662/4989 [==>...........................] - ETA: 4s - loss: 0.0162 - accuracy: 0.8153 712/4989 [===>..........................] - ETA: 4s - loss: 0.0160 - accuracy: 0.8172 764/4989 [===>..........................] - ETA: 4s - loss: 0.0159 - accuracy: 0.8171 813/4989 [===>..........................] - ETA: 4s - loss: 0.0160 - accuracy: 0.8171 862/4989 [====>.........................] - ETA: 4s - loss: 0.0159 - accuracy: 0.8196 912/4989 [====>.........................] - ETA: 4s - loss: 0.0159 - accuracy: 0.8187 965/4989 [====>.........................] - ETA: 4s - loss: 0.0160 - accuracy: 0.81771015/4989 [=====>........................] - ETA: 3s - loss: 0.0159 - accuracy: 0.81781057/4989 [=====>........................] - ETA: 3s - loss: 0.0159 - accuracy: 0.81671107/4989 [=====>........................] - ETA: 3s - loss: 0.0160 - accuracy: 0.81511156/4989 [=====>........................] - ETA: 3s - loss: 0.0159 - accuracy: 0.81681207/4989 [======>.......................] - ETA: 3s - loss: 0.0161 - accuracy: 0.81551259/4989 [======>.......................] - ETA: 3s - loss: 0.0161 - accuracy: 0.81601309/4989 [======>.......................] - ETA: 3s - loss: 0.0161 - accuracy: 0.81621362/4989 [=======>......................] - ETA: 3s - loss: 0.0162 - accuracy: 0.81521413/4989 [=======>......................] - ETA: 3s - loss: 0.0161 - accuracy: 0.81701463/4989 [=======>......................] - ETA: 3s - loss: 0.0162 - accuracy: 0.81671509/4989 [========>.....................] - ETA: 3s - loss: 0.0162 - accuracy: 0.81611540/4989 [========>.....................] - ETA: 3s - loss: 0.0162 - accuracy: 0.81581570/4989 [========>.....................] - ETA: 3s - loss: 0.0163 - accuracy: 0.81511603/4989 [========>.....................] - ETA: 3s - loss: 0.0163 - accuracy: 0.81501637/4989 [========>.....................] - ETA: 3s - loss: 0.0163 - accuracy: 0.81461673/4989 [=========>....................] - ETA: 3s - loss: 0.0163 - accuracy: 0.81531715/4989 [=========>....................] - ETA: 3s - loss: 0.0163 - accuracy: 0.81501764/4989 [=========>....................] - ETA: 3s - loss: 0.0164 - accuracy: 0.81371814/4989 [=========>....................] - ETA: 3s - loss: 0.0165 - accuracy: 0.81171866/4989 [==========>...................] - ETA: 3s - loss: 0.0166 - accuracy: 0.81201915/4989 [==========>...................] - ETA: 3s - loss: 0.0166 - accuracy: 0.81161960/4989 [==========>...................] - ETA: 3s - loss: 0.0166 - accuracy: 0.81222011/4989 [===========>..................] - ETA: 3s - loss: 0.0166 - accuracy: 0.81182064/4989 [===========>..................] - ETA: 3s - loss: 0.0166 - accuracy: 0.81212117/4989 [===========>..................] - ETA: 3s - loss: 0.0167 - accuracy: 0.81082171/4989 [============>.................] - ETA: 2s - loss: 0.0167 - accuracy: 0.81042222/4989 [============>.................] - ETA: 2s - loss: 0.0168 - accuracy: 0.81032272/4989 [============>.................] - ETA: 2s - loss: 0.0168 - accuracy: 0.80972324/4989 [============>.................] - ETA: 2s - loss: 0.0168 - accuracy: 0.80942378/4989 [=============>................] - ETA: 2s - loss: 0.0168 - accuracy: 0.80912428/4989 [=============>................] - ETA: 2s - loss: 0.0168 - accuracy: 0.80912476/4989 [=============>................] - ETA: 2s - loss: 0.0167 - accuracy: 0.80982518/4989 [==============>...............] - ETA: 2s - loss: 0.0167 - accuracy: 0.81062549/4989 [==============>...............] - ETA: 2s - loss: 0.0167 - accuracy: 0.81012583/4989 [==============>...............] - ETA: 2s - loss: 0.0167 - accuracy: 0.81042618/4989 [==============>...............] - ETA: 2s - loss: 0.0167 - accuracy: 0.81042660/4989 [==============>...............] - ETA: 2s - loss: 0.0167 - accuracy: 0.81092705/4989 [===============>..............] - ETA: 2s - loss: 0.0166 - accuracy: 0.81132754/4989 [===============>..............] - ETA: 2s - loss: 0.0167 - accuracy: 0.81072795/4989 [===============>..............] - ETA: 2s - loss: 0.0167 - accuracy: 0.81012828/4989 [================>.............] - ETA: 2s - loss: 0.0167 - accuracy: 0.81022871/4989 [================>.............] - ETA: 2s - loss: 0.0166 - accuracy: 0.81132917/4989 [================>.............] - ETA: 2s - loss: 0.0167 - accuracy: 0.81112969/4989 [================>.............] - ETA: 2s - loss: 0.0167 - accuracy: 0.81133020/4989 [=================>............] - ETA: 2s - loss: 0.0167 - accuracy: 0.81143073/4989 [=================>............] - ETA: 2s - loss: 0.0167 - accuracy: 0.81103124/4989 [=================>............] - ETA: 1s - loss: 0.0167 - accuracy: 0.81073177/4989 [==================>...........] - ETA: 1s - loss: 0.0167 - accuracy: 0.81113229/4989 [==================>...........] - ETA: 1s - loss: 0.0167 - accuracy: 0.81113282/4989 [==================>...........] - ETA: 1s - loss: 0.0167 - accuracy: 0.81103331/4989 [===================>..........] - ETA: 1s - loss: 0.0167 - accuracy: 0.81073374/4989 [===================>..........] - ETA: 1s - loss: 0.0167 - accuracy: 0.81083419/4989 [===================>..........] - ETA: 1s - loss: 0.0167 - accuracy: 0.81103455/4989 [===================>..........] - ETA: 1s - loss: 0.0167 - accuracy: 0.81093482/4989 [===================>..........] - ETA: 1s - loss: 0.0167 - accuracy: 0.81133504/4989 [====================>.........] - ETA: 1s - loss: 0.0167 - accuracy: 0.81123526/4989 [====================>.........] - ETA: 1s - loss: 0.0167 - accuracy: 0.81103545/4989 [====================>.........] - ETA: 1s - loss: 0.0167 - accuracy: 0.81103571/4989 [====================>.........] - ETA: 1s - loss: 0.0167 - accuracy: 0.81163609/4989 [====================>.........] - ETA: 1s - loss: 0.0167 - accuracy: 0.81133637/4989 [====================>.........] - ETA: 1s - loss: 0.0167 - accuracy: 0.81123671/4989 [=====================>........] - ETA: 1s - loss: 0.0168 - accuracy: 0.81123716/4989 [=====================>........] - ETA: 1s - loss: 0.0167 - accuracy: 0.81153764/4989 [=====================>........] - ETA: 1s - loss: 0.0167 - accuracy: 0.81103813/4989 [=====================>........] - ETA: 1s - loss: 0.0168 - accuracy: 0.81033852/4989 [======================>.......] - ETA: 1s - loss: 0.0168 - accuracy: 0.81033895/4989 [======================>.......] - ETA: 1s - loss: 0.0168 - accuracy: 0.81053936/4989 [======================>.......] - ETA: 1s - loss: 0.0168 - accuracy: 0.81043978/4989 [======================>.......] - ETA: 1s - loss: 0.0168 - accuracy: 0.81044024/4989 [=======================>......] - ETA: 1s - loss: 0.0168 - accuracy: 0.81064073/4989 [=======================>......] - ETA: 1s - loss: 0.0168 - accuracy: 0.81064120/4989 [=======================>......] - ETA: 0s - loss: 0.0168 - accuracy: 0.81074165/4989 [========================>.....] - ETA: 0s - loss: 0.0167 - accuracy: 0.81104211/4989 [========================>.....] - ETA: 0s - loss: 0.0167 - accuracy: 0.81124259/4989 [========================>.....] - ETA: 0s - loss: 0.0168 - accuracy: 0.81094308/4989 [========================>.....] - ETA: 0s - loss: 0.0168 - accuracy: 0.81054357/4989 [=========================>....] - ETA: 0s - loss: 0.0168 - accuracy: 0.81054408/4989 [=========================>....] - ETA: 0s - loss: 0.0168 - accuracy: 0.81024458/4989 [=========================>....] - ETA: 0s - loss: 0.0168 - accuracy: 0.81024508/4989 [==========================>...] - ETA: 0s - loss: 0.0168 - accuracy: 0.81054544/4989 [==========================>...] - ETA: 0s - loss: 0.0168 - accuracy: 0.81094592/4989 [==========================>...] - ETA: 0s - loss: 0.0168 - accuracy: 0.81044635/4989 [==========================>...] - ETA: 0s - loss: 0.0168 - accuracy: 0.81054680/4989 [===========================>..] - ETA: 0s - loss: 0.0168 - accuracy: 0.81044730/4989 [===========================>..] - ETA: 0s - loss: 0.0168 - accuracy: 0.81024761/4989 [===========================>..] - ETA: 0s - loss: 0.0168 - accuracy: 0.81004801/4989 [===========================>..] - ETA: 0s - loss: 0.0168 - accuracy: 0.81014850/4989 [============================>.] - ETA: 0s - loss: 0.0169 - accuracy: 0.80964901/4989 [============================>.] - ETA: 0s - loss: 0.0169 - accuracy: 0.80954952/4989 [============================>.] - ETA: 0s - loss: 0.0169 - accuracy: 0.8094
Epoch 3: val_loss improved from 0.01726 to 0.01710, saving model to TMVA_keras_models/keras_shallow_model_old_TMVA_trained_model.h5
4989/4989 [==============================] - 7s 1ms/step - loss: 0.0169 - accuracy: 0.8094 - val_loss: 0.0171 - val_accuracy: 0.8050
Epoch 4/5
   1/4989 [..............................] - ETA: 6s - loss: 0.0142 - accuracy: 0.8894  47/4989 [..............................] - ETA: 5s - loss: 0.0160 - accuracy: 0.8271  90/4989 [..............................] - ETA: 5s - loss: 0.0151 - accuracy: 0.8406 137/4989 [..............................] - ETA: 5s - loss: 0.0153 - accuracy: 0.8278 184/4989 [>.............................] - ETA: 5s - loss: 0.0167 - accuracy: 0.8181 237/4989 [>.............................] - ETA: 5s - loss: 0.0168 - accuracy: 0.8194 288/4989 [>.............................] - ETA: 4s - loss: 0.0170 - accuracy: 0.8129 336/4989 [=>............................] - ETA: 4s - loss: 0.0170 - accuracy: 0.8106 381/4989 [=>............................] - ETA: 4s - loss: 0.0169 - accuracy: 0.8098 425/4989 [=>............................] - ETA: 4s - loss: 0.0170 - accuracy: 0.8104 458/4989 [=>............................] - ETA: 5s - loss: 0.0169 - accuracy: 0.8107 497/4989 [=>............................] - ETA: 5s - loss: 0.0171 - accuracy: 0.8079 540/4989 [==>...........................] - ETA: 4s - loss: 0.0171 - accuracy: 0.8078 588/4989 [==>...........................] - ETA: 4s - loss: 0.0173 - accuracy: 0.8094 639/4989 [==>...........................] - ETA: 4s - loss: 0.0172 - accuracy: 0.8094 691/4989 [===>..........................] - ETA: 4s - loss: 0.0171 - accuracy: 0.8101 743/4989 [===>..........................] - ETA: 4s - loss: 0.0171 - accuracy: 0.8112 797/4989 [===>..........................] - ETA: 4s - loss: 0.0170 - accuracy: 0.8131 849/4989 [====>.........................] - ETA: 4s - loss: 0.0168 - accuracy: 0.8150 901/4989 [====>.........................] - ETA: 4s - loss: 0.0170 - accuracy: 0.8145 951/4989 [====>.........................] - ETA: 4s - loss: 0.0169 - accuracy: 0.81611003/4989 [=====>........................] - ETA: 4s - loss: 0.0171 - accuracy: 0.81251055/4989 [=====>........................] - ETA: 4s - loss: 0.0171 - accuracy: 0.81151106/4989 [=====>........................] - ETA: 4s - loss: 0.0172 - accuracy: 0.81101159/4989 [=====>........................] - ETA: 4s - loss: 0.0171 - accuracy: 0.81231211/4989 [======>.......................] - ETA: 3s - loss: 0.0171 - accuracy: 0.81291263/4989 [======>.......................] - ETA: 3s - loss: 0.0170 - accuracy: 0.81341313/4989 [======>.......................] - ETA: 3s - loss: 0.0169 - accuracy: 0.81511347/4989 [=======>......................] - ETA: 3s - loss: 0.0171 - accuracy: 0.81361379/4989 [=======>......................] - ETA: 3s - loss: 0.0171 - accuracy: 0.81311402/4989 [=======>......................] - ETA: 3s - loss: 0.0171 - accuracy: 0.81351432/4989 [=======>......................] - ETA: 3s - loss: 0.0171 - accuracy: 0.81311478/4989 [=======>......................] - ETA: 3s - loss: 0.0171 - accuracy: 0.81201527/4989 [========>.....................] - ETA: 3s - loss: 0.0171 - accuracy: 0.81031579/4989 [========>.....................] - ETA: 3s - loss: 0.0171 - accuracy: 0.81011631/4989 [========>.....................] - ETA: 3s - loss: 0.0172 - accuracy: 0.80861683/4989 [=========>....................] - ETA: 3s - loss: 0.0171 - accuracy: 0.80921735/4989 [=========>....................] - ETA: 3s - loss: 0.0172 - accuracy: 0.80841787/4989 [=========>....................] - ETA: 3s - loss: 0.0171 - accuracy: 0.80871838/4989 [==========>...................] - ETA: 3s - loss: 0.0172 - accuracy: 0.80691890/4989 [==========>...................] - ETA: 3s - loss: 0.0172 - accuracy: 0.80641940/4989 [==========>...................] - ETA: 3s - loss: 0.0172 - accuracy: 0.80681989/4989 [==========>...................] - ETA: 3s - loss: 0.0172 - accuracy: 0.80752042/4989 [===========>..................] - ETA: 3s - loss: 0.0171 - accuracy: 0.80862093/4989 [===========>..................] - ETA: 3s - loss: 0.0171 - accuracy: 0.80882148/4989 [===========>..................] - ETA: 3s - loss: 0.0171 - accuracy: 0.80772195/4989 [============>.................] - ETA: 2s - loss: 0.0170 - accuracy: 0.80902245/4989 [============>.................] - ETA: 2s - loss: 0.0170 - accuracy: 0.80942294/4989 [============>.................] - ETA: 2s - loss: 0.0170 - accuracy: 0.81052337/4989 [=============>................] - ETA: 2s - loss: 0.0170 - accuracy: 0.81002382/4989 [=============>................] - ETA: 2s - loss: 0.0170 - accuracy: 0.81002432/4989 [=============>................] - ETA: 2s - loss: 0.0170 - accuracy: 0.80902471/4989 [=============>................] - ETA: 2s - loss: 0.0170 - accuracy: 0.80922513/4989 [==============>...............] - ETA: 2s - loss: 0.0169 - accuracy: 0.80932554/4989 [==============>...............] - ETA: 2s - loss: 0.0169 - accuracy: 0.81032599/4989 [==============>...............] - ETA: 2s - loss: 0.0169 - accuracy: 0.80912645/4989 [==============>...............] - ETA: 2s - loss: 0.0169 - accuracy: 0.80922688/4989 [===============>..............] - ETA: 2s - loss: 0.0169 - accuracy: 0.80892721/4989 [===============>..............] - ETA: 2s - loss: 0.0169 - accuracy: 0.80892747/4989 [===============>..............] - ETA: 2s - loss: 0.0169 - accuracy: 0.80932775/4989 [===============>..............] - ETA: 2s - loss: 0.0169 - accuracy: 0.80882818/4989 [===============>..............] - ETA: 2s - loss: 0.0169 - accuracy: 0.80862868/4989 [================>.............] - ETA: 2s - loss: 0.0169 - accuracy: 0.80862918/4989 [================>.............] - ETA: 2s - loss: 0.0169 - accuracy: 0.80852969/4989 [================>.............] - ETA: 2s - loss: 0.0170 - accuracy: 0.80833014/4989 [=================>............] - ETA: 2s - loss: 0.0170 - accuracy: 0.80823056/4989 [=================>............] - ETA: 2s - loss: 0.0170 - accuracy: 0.80813099/4989 [=================>............] - ETA: 2s - loss: 0.0169 - accuracy: 0.80853144/4989 [=================>............] - ETA: 2s - loss: 0.0169 - accuracy: 0.80843173/4989 [==================>...........] - ETA: 1s - loss: 0.0169 - accuracy: 0.80813212/4989 [==================>...........] - ETA: 1s - loss: 0.0169 - accuracy: 0.80823243/4989 [==================>...........] - ETA: 1s - loss: 0.0169 - accuracy: 0.80823289/4989 [==================>...........] - ETA: 1s - loss: 0.0169 - accuracy: 0.80823337/4989 [===================>..........] - ETA: 1s - loss: 0.0169 - accuracy: 0.80793385/4989 [===================>..........] - ETA: 1s - loss: 0.0169 - accuracy: 0.80833435/4989 [===================>..........] - ETA: 1s - loss: 0.0169 - accuracy: 0.80853481/4989 [===================>..........] - ETA: 1s - loss: 0.0169 - accuracy: 0.80803520/4989 [====================>.........] - ETA: 1s - loss: 0.0169 - accuracy: 0.80813562/4989 [====================>.........] - ETA: 1s - loss: 0.0169 - accuracy: 0.80783605/4989 [====================>.........] - ETA: 1s - loss: 0.0169 - accuracy: 0.80833649/4989 [====================>.........] - ETA: 1s - loss: 0.0169 - accuracy: 0.80783688/4989 [=====================>........] - ETA: 1s - loss: 0.0169 - accuracy: 0.80763728/4989 [=====================>........] - ETA: 1s - loss: 0.0169 - accuracy: 0.80763772/4989 [=====================>........] - ETA: 1s - loss: 0.0169 - accuracy: 0.80753817/4989 [=====================>........] - ETA: 1s - loss: 0.0169 - accuracy: 0.80753865/4989 [======================>.......] - ETA: 1s - loss: 0.0169 - accuracy: 0.80783914/4989 [======================>.......] - ETA: 1s - loss: 0.0169 - accuracy: 0.80763961/4989 [======================>.......] - ETA: 1s - loss: 0.0169 - accuracy: 0.80754006/4989 [=======================>......] - ETA: 1s - loss: 0.0168 - accuracy: 0.80804042/4989 [=======================>......] - ETA: 1s - loss: 0.0168 - accuracy: 0.80834087/4989 [=======================>......] - ETA: 1s - loss: 0.0168 - accuracy: 0.80794127/4989 [=======================>......] - ETA: 0s - loss: 0.0168 - accuracy: 0.80804167/4989 [========================>.....] - ETA: 0s - loss: 0.0168 - accuracy: 0.80844202/4989 [========================>.....] - ETA: 0s - loss: 0.0168 - accuracy: 0.80834239/4989 [========================>.....] - ETA: 0s - loss: 0.0168 - accuracy: 0.80844269/4989 [========================>.....] - ETA: 0s - loss: 0.0168 - accuracy: 0.80874312/4989 [========================>.....] - ETA: 0s - loss: 0.0168 - accuracy: 0.80834361/4989 [=========================>....] - ETA: 0s - loss: 0.0168 - accuracy: 0.80824411/4989 [=========================>....] - ETA: 0s - loss: 0.0168 - accuracy: 0.80894461/4989 [=========================>....] - ETA: 0s - loss: 0.0167 - accuracy: 0.80924511/4989 [==========================>...] - ETA: 0s - loss: 0.0167 - accuracy: 0.80914560/4989 [==========================>...] - ETA: 0s - loss: 0.0167 - accuracy: 0.80894610/4989 [==========================>...] - ETA: 0s - loss: 0.0167 - accuracy: 0.80874659/4989 [===========================>..] - ETA: 0s - loss: 0.0168 - accuracy: 0.80874708/4989 [===========================>..] - ETA: 0s - loss: 0.0168 - accuracy: 0.80874757/4989 [===========================>..] - ETA: 0s - loss: 0.0168 - accuracy: 0.80884807/4989 [===========================>..] - ETA: 0s - loss: 0.0168 - accuracy: 0.80924858/4989 [============================>.] - ETA: 0s - loss: 0.0168 - accuracy: 0.80924908/4989 [============================>.] - ETA: 0s - loss: 0.0168 - accuracy: 0.80934952/4989 [============================>.] - ETA: 0s - loss: 0.0168 - accuracy: 0.8092
Epoch 4: val_loss did not improve from 0.01710
4989/4989 [==============================] - 7s 1ms/step - loss: 0.0168 - accuracy: 0.8096 - val_loss: 0.0172 - val_accuracy: 0.8066
Epoch 5/5
   1/4989 [..............................] - ETA: 5s - loss: 0.0247 - accuracy: 0.7600  52/4989 [..............................] - ETA: 4s - loss: 0.0156 - accuracy: 0.8575 104/4989 [..............................] - ETA: 4s - loss: 0.0163 - accuracy: 0.8240 156/4989 [..............................] - ETA: 4s - loss: 0.0160 - accuracy: 0.8252 209/4989 [>.............................] - ETA: 4s - loss: 0.0164 - accuracy: 0.8238 260/4989 [>.............................] - ETA: 4s - loss: 0.0167 - accuracy: 0.8235 313/4989 [>.............................] - ETA: 4s - loss: 0.0166 - accuracy: 0.8244 364/4989 [=>............................] - ETA: 4s - loss: 0.0165 - accuracy: 0.8251 411/4989 [=>............................] - ETA: 4s - loss: 0.0165 - accuracy: 0.8224 458/4989 [=>............................] - ETA: 4s - loss: 0.0164 - accuracy: 0.8271 508/4989 [==>...........................] - ETA: 4s - loss: 0.0163 - accuracy: 0.8275 555/4989 [==>...........................] - ETA: 4s - loss: 0.0164 - accuracy: 0.8270 606/4989 [==>...........................] - ETA: 4s - loss: 0.0164 - accuracy: 0.8250 655/4989 [==>...........................] - ETA: 4s - loss: 0.0163 - accuracy: 0.8243 684/4989 [===>..........................] - ETA: 4s - loss: 0.0165 - accuracy: 0.8231 717/4989 [===>..........................] - ETA: 4s - loss: 0.0164 - accuracy: 0.8255 748/4989 [===>..........................] - ETA: 4s - loss: 0.0167 - accuracy: 0.8230 772/4989 [===>..........................] - ETA: 4s - loss: 0.0167 - accuracy: 0.8209 803/4989 [===>..........................] - ETA: 4s - loss: 0.0167 - accuracy: 0.8187 822/4989 [===>..........................] - ETA: 4s - loss: 0.0168 - accuracy: 0.8174 849/4989 [====>.........................] - ETA: 4s - loss: 0.0168 - accuracy: 0.8184 886/4989 [====>.........................] - ETA: 4s - loss: 0.0167 - accuracy: 0.8180 920/4989 [====>.........................] - ETA: 4s - loss: 0.0169 - accuracy: 0.8141 960/4989 [====>.........................] - ETA: 4s - loss: 0.0169 - accuracy: 0.81361007/4989 [=====>........................] - ETA: 4s - loss: 0.0169 - accuracy: 0.81331054/4989 [=====>........................] - ETA: 4s - loss: 0.0169 - accuracy: 0.81361103/4989 [=====>........................] - ETA: 4s - loss: 0.0170 - accuracy: 0.81361145/4989 [=====>........................] - ETA: 4s - loss: 0.0169 - accuracy: 0.81381187/4989 [======>.......................] - ETA: 4s - loss: 0.0170 - accuracy: 0.81201227/4989 [======>.......................] - ETA: 4s - loss: 0.0170 - accuracy: 0.81211269/4989 [======>.......................] - ETA: 4s - loss: 0.0170 - accuracy: 0.81121306/4989 [======>.......................] - ETA: 4s - loss: 0.0170 - accuracy: 0.81131349/4989 [=======>......................] - ETA: 4s - loss: 0.0171 - accuracy: 0.80961392/4989 [=======>......................] - ETA: 4s - loss: 0.0171 - accuracy: 0.80861438/4989 [=======>......................] - ETA: 4s - loss: 0.0170 - accuracy: 0.80941485/4989 [=======>......................] - ETA: 4s - loss: 0.0170 - accuracy: 0.80941535/4989 [========>.....................] - ETA: 4s - loss: 0.0169 - accuracy: 0.81051585/4989 [========>.....................] - ETA: 4s - loss: 0.0169 - accuracy: 0.80991636/4989 [========>.....................] - ETA: 3s - loss: 0.0169 - accuracy: 0.81071678/4989 [=========>....................] - ETA: 3s - loss: 0.0170 - accuracy: 0.81081728/4989 [=========>....................] - ETA: 3s - loss: 0.0169 - accuracy: 0.81081777/4989 [=========>....................] - ETA: 3s - loss: 0.0169 - accuracy: 0.81061821/4989 [=========>....................] - ETA: 3s - loss: 0.0169 - accuracy: 0.81001867/4989 [==========>...................] - ETA: 3s - loss: 0.0169 - accuracy: 0.80961901/4989 [==========>...................] - ETA: 3s - loss: 0.0170 - accuracy: 0.80801940/4989 [==========>...................] - ETA: 3s - loss: 0.0170 - accuracy: 0.80771980/4989 [==========>...................] - ETA: 3s - loss: 0.0170 - accuracy: 0.80752020/4989 [===========>..................] - ETA: 3s - loss: 0.0170 - accuracy: 0.80852060/4989 [===========>..................] - ETA: 3s - loss: 0.0170 - accuracy: 0.80792099/4989 [===========>..................] - ETA: 3s - loss: 0.0169 - accuracy: 0.80842139/4989 [===========>..................] - ETA: 3s - loss: 0.0169 - accuracy: 0.80842179/4989 [============>.................] - ETA: 3s - loss: 0.0169 - accuracy: 0.80902216/4989 [============>.................] - ETA: 3s - loss: 0.0168 - accuracy: 0.81012260/4989 [============>.................] - ETA: 3s - loss: 0.0168 - accuracy: 0.81042307/4989 [============>.................] - ETA: 3s - loss: 0.0168 - accuracy: 0.80972354/4989 [=============>................] - ETA: 3s - loss: 0.0168 - accuracy: 0.80922399/4989 [=============>................] - ETA: 3s - loss: 0.0168 - accuracy: 0.80882446/4989 [=============>................] - ETA: 2s - loss: 0.0168 - accuracy: 0.80872494/4989 [=============>................] - ETA: 2s - loss: 0.0169 - accuracy: 0.80842537/4989 [==============>...............] - ETA: 2s - loss: 0.0168 - accuracy: 0.80852588/4989 [==============>...............] - ETA: 2s - loss: 0.0168 - accuracy: 0.80862638/4989 [==============>...............] - ETA: 2s - loss: 0.0168 - accuracy: 0.80892689/4989 [===============>..............] - ETA: 2s - loss: 0.0168 - accuracy: 0.80932736/4989 [===============>..............] - ETA: 2s - loss: 0.0168 - accuracy: 0.80902785/4989 [===============>..............] - ETA: 2s - loss: 0.0169 - accuracy: 0.80862835/4989 [================>.............] - ETA: 2s - loss: 0.0169 - accuracy: 0.80872884/4989 [================>.............] - ETA: 2s - loss: 0.0169 - accuracy: 0.80842934/4989 [================>.............] - ETA: 2s - loss: 0.0169 - accuracy: 0.80902983/4989 [================>.............] - ETA: 2s - loss: 0.0168 - accuracy: 0.80973032/4989 [=================>............] - ETA: 2s - loss: 0.0168 - accuracy: 0.80993082/4989 [=================>............] - ETA: 2s - loss: 0.0168 - accuracy: 0.80953131/4989 [=================>............] - ETA: 2s - loss: 0.0168 - accuracy: 0.80993182/4989 [==================>...........] - ETA: 2s - loss: 0.0168 - accuracy: 0.80973231/4989 [==================>...........] - ETA: 2s - loss: 0.0168 - accuracy: 0.80973280/4989 [==================>...........] - ETA: 1s - loss: 0.0168 - accuracy: 0.80943330/4989 [===================>..........] - ETA: 1s - loss: 0.0168 - accuracy: 0.80923383/4989 [===================>..........] - ETA: 1s - loss: 0.0168 - accuracy: 0.80993434/4989 [===================>..........] - ETA: 1s - loss: 0.0168 - accuracy: 0.80993476/4989 [===================>..........] - ETA: 1s - loss: 0.0168 - accuracy: 0.81003526/4989 [====================>.........] - ETA: 1s - loss: 0.0168 - accuracy: 0.80953577/4989 [====================>.........] - ETA: 1s - loss: 0.0168 - accuracy: 0.80933627/4989 [====================>.........] - ETA: 1s - loss: 0.0169 - accuracy: 0.80913677/4989 [=====================>........] - ETA: 1s - loss: 0.0169 - accuracy: 0.80933726/4989 [=====================>........] - ETA: 1s - loss: 0.0169 - accuracy: 0.80933775/4989 [=====================>........] - ETA: 1s - loss: 0.0168 - accuracy: 0.80973823/4989 [=====================>........] - ETA: 1s - loss: 0.0168 - accuracy: 0.80983877/4989 [======================>.......] - ETA: 1s - loss: 0.0168 - accuracy: 0.80973926/4989 [======================>.......] - ETA: 1s - loss: 0.0168 - accuracy: 0.80963977/4989 [======================>.......] - ETA: 1s - loss: 0.0168 - accuracy: 0.80974028/4989 [=======================>......] - ETA: 1s - loss: 0.0167 - accuracy: 0.80974080/4989 [=======================>......] - ETA: 1s - loss: 0.0168 - accuracy: 0.80974132/4989 [=======================>......] - ETA: 0s - loss: 0.0167 - accuracy: 0.81004183/4989 [========================>.....] - ETA: 0s - loss: 0.0168 - accuracy: 0.80964231/4989 [========================>.....] - ETA: 0s - loss: 0.0167 - accuracy: 0.81014284/4989 [========================>.....] - ETA: 0s - loss: 0.0167 - accuracy: 0.81014332/4989 [=========================>....] - ETA: 0s - loss: 0.0167 - accuracy: 0.81044380/4989 [=========================>....] - ETA: 0s - loss: 0.0167 - accuracy: 0.81054429/4989 [=========================>....] - ETA: 0s - loss: 0.0167 - accuracy: 0.81094474/4989 [=========================>....] - ETA: 0s - loss: 0.0167 - accuracy: 0.81054526/4989 [==========================>...] - ETA: 0s - loss: 0.0167 - accuracy: 0.81084577/4989 [==========================>...] - ETA: 0s - loss: 0.0167 - accuracy: 0.81094626/4989 [==========================>...] - ETA: 0s - loss: 0.0167 - accuracy: 0.81084678/4989 [===========================>..] - ETA: 0s - loss: 0.0167 - accuracy: 0.81044727/4989 [===========================>..] - ETA: 0s - loss: 0.0167 - accuracy: 0.81044779/4989 [===========================>..] - ETA: 0s - loss: 0.0167 - accuracy: 0.81064828/4989 [============================>.] - ETA: 0s - loss: 0.0167 - accuracy: 0.81094875/4989 [============================>.] - ETA: 0s - loss: 0.0167 - accuracy: 0.81084924/4989 [============================>.] - ETA: 0s - loss: 0.0167 - accuracy: 0.81084972/4989 [============================>.] - ETA: 0s - loss: 0.0167 - accuracy: 0.8108
Epoch 5: val_loss did not improve from 0.01710
4989/4989 [==============================] - 6s 1ms/step - loss: 0.0167 - accuracy: 0.8107 - val_loss: 0.0171 - val_accuracy: 0.8083
                         : Getting training history for item:0 name = 'loss'
                         : Getting training history for item:1 name = 'accuracy'
                         : Getting training history for item:2 name = 'val_loss'
                         : Getting training history for item:3 name = 'val_accuracy'
                         : Elapsed time for training with 399092 events: [1;31m106 sec[0m         
                         : Setting up tf.keras
                         : Using TensorFlow version 2
                         : Use Keras version from TensorFlow : tf.keras
                         : Disabled TF eager execution when evaluating model 
                         :  Loading Keras Model 
                         : Loaded model from file: TMVA_keras_models/keras_shallow_model_old_TMVA_trained_model.h5
PyKeras                  : [dataset] : Evaluation of PyKeras on training sample (399092 events)
                         : Elapsed time for evaluation of 399092 events: [1;31m3.82 sec[0m       
                         : Creating xml weight file: [0;36mdataset/weights/TMVAClassification_PyKeras.weights.xml[0m
                         : Creating standalone class: [0;36mdataset/weights/TMVAClassification_PyKeras.class.C[0m
Factory                  : Training finished
                         : 
                         : Ranking input variables (method specific)...
                         : No variable ranking supplied by classifier: PyKeras
TH1.Print Name  = TrainingHistory_PyKeras_'accuracy', Entries= 0, Total sum= 4.03779
TH1.Print Name  = TrainingHistory_PyKeras_'loss', Entries= 0, Total sum= 0.0852648
TH1.Print Name  = TrainingHistory_PyKeras_'val_accuracy', Entries= 0, Total sum= 4.02191
TH1.Print Name  = TrainingHistory_PyKeras_'val_loss', Entries= 0, Total sum= 0.0866052
Factory                  : === Destroy and recreate all methods via weight files for testing ===
                         : 
                         : Reading weight file: [0;36mdataset/weights/TMVAClassification_PyKeras.weights.xml[0m
Factory                  : [1mTest all methods[0m
Factory                  : Test method: PyKeras for Classification performance
                         : 
                         : Setting up tf.keras
                         : Using TensorFlow version 2
                         : Use Keras version from TensorFlow : tf.keras
                         : Disabled TF eager execution when evaluating model 
                         :  Loading Keras Model 
                         : Loaded model from file: TMVA_keras_models/keras_shallow_model_old_TMVA_trained_model.h5
PyKeras                  : [dataset] : Evaluation of PyKeras on testing sample (99772 events)
                         : Elapsed time for evaluation of 99772 events: [1;31m0.914 sec[0m       
Factory                  : [1mEvaluate all methods[0m
Factory                  : Evaluate classifier: PyKeras
                         : 
PyKeras                  : [dataset] : Loop over test events and fill histograms with classifier response...
                         : 
TFHandler_PyKeras        :                 Variable                        Mean                        RMS                [        Min                        Max ]
                         : -------------------------------------------------------------------------------------------------------------------------------------------
                         :        C_mu_Ds_BS_ips_xy:                    8.8281                    11.265   [                9.3854e-05                    323.18 ]
                         :              C_mu1mu2_dr:                   0.16406                  0.071900   [                0.00052184                   0.53738 ]
                         :       C_mu_Hnl_BS_ips_xy:                    27.663                    27.121   [                7.3862e-05                    257.46 ]
                         : C_mu_Hnl_nValidPixelHits:                    3.2599                   0.96935   [                    0.0000                    7.0000 ]
                         : -------------------------------------------------------------------------------------------------------------------------------------------
                         : 
                         : Evaluation results ranked by best signal efficiency and purity (area)
                         : -------------------------------------------------------------------------------------------------------------------
                         : DataSet       MVA                       
                         : Name:         Method:          ROC-integ
                         : dataset       PyKeras        : 0.892
                         : -------------------------------------------------------------------------------------------------------------------
                         : 
                         : Testing efficiency compared to training efficiency (overtraining check)
                         : -------------------------------------------------------------------------------------------------------------------
                         : DataSet              MVA              Signal efficiency: from test sample (from training sample) 
                         : Name:                Method:          @B=0.01             @B=0.10            @B=0.30   
                         : -------------------------------------------------------------------------------------------------------------------
                         : dataset              PyKeras        : 0.343 (0.345)       0.724 (0.730)      0.881 (0.882)
                         : -------------------------------------------------------------------------------------------------------------------
                         : 
Dataset:dataset          : Created tree 'TestTree' with 99772 events
                         : 
Dataset:dataset          : Created tree 'TrainTree' with 399092 events
                         : 
Factory                  : [1mThank you for using TMVA![0m
                         : [1mFor citation information, please visit: http://tmva.sf.net/citeTMVA.html[0m
